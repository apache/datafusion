CREATE TABLE
    EMPLOYEE (
        ID INT,
        NAME STRING,
        AGE INT,
        SALARY FLOAT,
        DEPT STRING,
        CREATED_DATE DATE,
        UPDATED_DATE TIMESTAMP,
        VERSION INT
    );

-- Insert 100 rows into EMPLOYEE table
INSERT INTO
    EMPLOYEE
VALUES
    (
        10,
        'Dan',
        30,
        1500.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        11,
        'Michelle',
        34,
        1800.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        12,
        'Ryan',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        13,
        'Gary',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        14,
        'Nina',
        34,
        1800.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        15,
        'Simon',
        25,
        1000.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        16,
        'Guru',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        17,
        'Rick',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        18,
        'Dan',
        30,
        1500.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        19,
        'Michelle',
        34,
        1800.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        20,
        'Ryan',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        21,
        'Gary',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        22,
        'Nina',
        34,
        1800.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        23,
        'Simon',
        25,
        1000.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        24,
        'Guru',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        25,
        'Rick',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        26,
        'Dan',
        30,
        1500.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        27,
        'Michelle',
        34,
        1800.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        28,
        'Ryan',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        29,
        'Gary',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        30,
        'Nina',
        34,
        1800.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        31,
        'Simon',
        25,
        1000.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        32,
        'Guru',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        33,
        'Rick',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        34,
        'Dan',
        30,
        1500.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        35,
        'Michelle',
        34,
        1800.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        36,
        'Ryan',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        37,
        'Gary',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        38,
        'Nina',
        34,
        1800.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        39,
        'Simon',
        25,
        1000.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        40,
        'Guru',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        41,
        'Rick',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        42,
        'Dan',
        30,
        1500.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        43,
        'Michelle',
        34,
        1800.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        44,
        'Ryan',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        45,
        'Gary',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        46,
        'Nina',
        34,
        1800.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        47,
        'Simon',
        25,
        1000.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        48,
        'Guru',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        49,
        'Rick',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        50,
        'Dan',
        30,
        1500.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        51,
        'Michelle',
        34,
        1800.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        52,
        'Ryan',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        53,
        'Gary',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        54,
        'Nina',
        34,
        1800.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        55,
        'Simon',
        25,
        1000.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        56,
        'Guru',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        57,
        'Rick',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        58,
        'Dan',
        30,
        1500.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        59,
        'Michelle',
        34,
        1800.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        60,
        'Ryan',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        61,
        'Gary',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        62,
        'Nina',
        34,
        1800.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        63,
        'Simon',
        25,
        1000.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        64,
        'Guru',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        65,
        'Rick',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        66,
        'Dan',
        30,
        1500.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        67,
        'Michelle',
        34,
        1800.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        68,
        'Ryan',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        69,
        'Gary',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        70,
        'Nina',
        34,
        1800.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        71,
        'Simon',
        25,
        1000.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        72,
        'Guru',
        30,
        1500.0,
        'Finance',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        73,
        'Rick',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        74,
        'Dan',
        30,
        1500.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        75,
        'Michelle',
        34,
        1800.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

INSERT INTO
    EMPLOYEE
VALUES
    (
        76,
        'Ryan',
        25,
        1000.0,
        'HR',
        '2020-01-01',
        '2020-01-01 00:00:00',
        1
    );

EXPLAIN
SELECT
    Avg(SALARY),
    Dept
FROM
    EMPLOYEE
WHERE
    AGE > 30
    AND SALARY > 1500.0
    AND STARTS_WITH(NAME, 'M')
GROUP BY
    Dept
ORDER BY
    Avg(SALARY) DESC;