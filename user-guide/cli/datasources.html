<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Local Files / Directories &#8212; Apache DataFusion  documentation</title>
    
    <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/pydata-sphinx-theme.css?v=1140d252" />
    <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css?v=c6d785ac" />
    
    <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script src="../../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DataFrame API" href="../dataframe.html" />
    <link rel="prev" title="Usage" href="usage.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    


    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items">

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  ASF Links
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://apache.org">
   Apache Software Foundation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.apache.org/licenses/">
   License
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.apache.org/foundation/sponsorship.html">
   Donate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.apache.org/foundation/thanks.html">
   Thanks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.apache.org/security/">
   Security
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Links
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/apache/datafusion">
   GitHub and Issue Tracker
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://crates.io/crates/datafusion">
   crates.io
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.rs/datafusion/latest/datafusion/">
   API Docs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://datafusion.apache.org/blog/">
   Blog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/apache/datafusion/blob/main/CODE_OF_CONDUCT.md">
   Code of conduct
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../download.html">
   Download
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  User Guide
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../example-usage.html">
   Example Usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../features.html">
   Features
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../concepts-readings-events.html">
   Concepts, Readings, Events
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../crate-configuration.html">
   Crate Configuration
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   DataFusion CLI
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="overview.html">
     Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="installation.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="usage.html">
     Usage
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Local Files / Directories
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dataframe.html">
   DataFrame API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../expressions.html">
   Expression API
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../sql/index.html">
   SQL Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/data_types.html">
     Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/select.html">
     SELECT syntax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/subqueries.html">
     Subqueries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/ddl.html">
     DDL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/dml.html">
     DML
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/explain.html">
     EXPLAIN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/information_schema.html">
     Information Schema
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/operators.html">
     Operators and Literals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/aggregate_functions.html">
     Aggregate Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/window_functions.html">
     Window Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/scalar_functions.html">
     Scalar Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/special_functions.html">
     Special Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/format_options.html">
     Format Options
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sql/prepared_statements.html">
     Prepared Statements
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../configs.html">
   Configuration Settings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../explain-usage.html">
   Reading Explain Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq.html">
   Frequently Asked Questions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Library User Guide
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/index.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/upgrading.html">
   Upgrade Guides
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/extensions.html">
   Extensions List
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/using-the-sql-api.html">
   Using the SQL API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/working-with-exprs.html">
   Working with
   <code class="docutils literal notranslate">
    <span class="pre">
     Expr
    </span>
   </code>
   s
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/using-the-dataframe-api.html">
   Using the DataFrame API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/building-logical-plans.html">
   Building Logical Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/catalogs.html">
   Catalogs, Schemas, and Tables
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../library-user-guide/functions/index.html">
   Functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../library-user-guide/functions/adding-udfs.html">
     Adding User Defined Functions: Scalar/Window/Aggregate/Table Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../library-user-guide/functions/spark.html">
     Spark Compatible Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/custom-table-providers.html">
   Custom Table Provider
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/table-constraints.html">
   Table Constraint Enforcement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/extending-operators.html">
   Extending DataFusion’s operators: custom LogicalPlan and Execution Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/profiling.html">
   Profiling Cookbook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../library-user-guide/query-optimizer.html">
   DataFusion Query Optimizer
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contributor Guide
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/index.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/communication.html">
   Communication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/development_environment.html">
   Development Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/architecture.html">
   Architecture
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/testing.html">
   Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/api-health.html">
   API health policy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/howtos.html">
   HOWTOs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/roadmap.html">
   Roadmap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/governance.html">
   Governance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/inviting.html">
   Inviting New Committers and PMC Members
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../contributor-guide/specification/index.html">
   Specifications
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../contributor-guide/specification/invariants.html">
     Invariants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../contributor-guide/specification/output-field-name-semantic.html">
     Output field name semantics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/gsoc_application_guidelines.html">
   GSoC Application Guidelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/gsoc_project_ideas.html">
   GSoC Project Ideas
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  DataFusion Subprojects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://arrow.apache.org/ballista/">
   DataFusion Ballista
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://datafusion.apache.org/comet/">
   DataFusion Comet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://datafusion.apache.org/python/">
   DataFusion Python
  </a>
 </li>
</ul>

    
  </div>

  <a class="navbar-brand" href="../../index.html">
    <img src="../../_static/images/2x_bgwhite_original.png" class="logo" alt="logo">
  </a>
</nav>

              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Local Files / Directories
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#remote-files-directories">
   Remote Files / Directories
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-external-table">
   <code class="docutils literal notranslate">
    <span class="pre">
     CREATE
    </span>
    <span class="pre">
     EXTERNAL
    </span>
    <span class="pre">
     TABLE
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#formats">
   Formats
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parquet">
     Parquet
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#parquet-specific-options">
       Parquet Specific Options
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#csv">
     CSV
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#locations">
   Locations
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#http-s">
     HTTP(s)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s3">
     S3
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#oss">
     OSS
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cos">
     COS
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gcs">
     GCS
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/apache/arrow-datafusion/edit/main/docs/source/user-guide/cli/datasources.md">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <!---
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License.
-->
<section id="local-files-directories">
<h1>Local Files / Directories<a class="headerlink" href="#local-files-directories" title="Link to this heading">¶</a></h1>
<p>Files can be queried directly by enclosing the file, directory name
or a remote location in single <code class="docutils literal notranslate"><span class="pre">'</span></code> quotes as shown in the examples.</p>
<p>Create a CSV file to query.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;a,b&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>data.csv
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;1,2&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>data.csv
</pre></div>
</div>
<p>Query that single file (the CLI also supports parquet, compressed csv, avro, json and more)</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>datafusion-cli
DataFusion<span class="w"> </span>CLI<span class="w"> </span>v17.0.0
&gt;<span class="w"> </span><span class="k">select</span><span class="w"> </span>*<span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;data.csv&#39;</span><span class="p">;</span>
+---+---+
<span class="p">|</span><span class="w"> </span>a<span class="w"> </span><span class="p">|</span><span class="w"> </span>b<span class="w"> </span><span class="p">|</span>
+---+---+
<span class="p">|</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">|</span>
+---+---+
<span class="m">1</span><span class="w"> </span>row<span class="w"> </span><span class="k">in</span><span class="w"> </span>set.<span class="w"> </span>Query<span class="w"> </span>took<span class="w"> </span><span class="m">0</span>.007<span class="w"> </span>seconds.
</pre></div>
</div>
<p>You can also query directories of files with compatible schemas:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ls<span class="w"> </span>data_dir/
data.csv<span class="w">   </span>data2.csv
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>datafusion-cli
DataFusion<span class="w"> </span>CLI<span class="w"> </span>v16.0.0
&gt;<span class="w"> </span><span class="k">select</span><span class="w"> </span>*<span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;data_dir&#39;</span><span class="p">;</span>
+---+---+
<span class="p">|</span><span class="w"> </span>a<span class="w"> </span><span class="p">|</span><span class="w"> </span>b<span class="w"> </span><span class="p">|</span>
+---+---+
<span class="p">|</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">|</span>
+---+---+
<span class="m">2</span><span class="w"> </span>rows<span class="w"> </span><span class="k">in</span><span class="w"> </span>set.<span class="w"> </span>Query<span class="w"> </span>took<span class="w"> </span><span class="m">0</span>.007<span class="w"> </span>seconds.
</pre></div>
</div>
</section>
<section id="remote-files-directories">
<h1>Remote Files / Directories<a class="headerlink" href="#remote-files-directories" title="Link to this heading">¶</a></h1>
<p>You can also query directly any remote location supported by DataFusion without
registering the location as a table.
For example, to read from a remote parquet file via HTTP(S) you can use the following:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="s1">&#39;https://datasets.clickhouse.com/hits_compatible/athena_partitioned/hits_1.parquet&#39;</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1000000</span><span class="w">  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="mi">1</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="p">.</span><span class="w"> </span><span class="n">Query</span><span class="w"> </span><span class="n">took</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">595</span><span class="w"> </span><span class="n">seconds</span><span class="p">.</span>
</pre></div>
</div>
<p>To read from an AWS S3 or GCS, use <code class="docutils literal notranslate"><span class="pre">s3</span></code> or <code class="docutils literal notranslate"><span class="pre">gs</span></code> as a protocol prefix. For
example, to read a file in an S3 bucket named <code class="docutils literal notranslate"><span class="pre">my-data-bucket</span></code> use the URL
<code class="docutils literal notranslate"><span class="pre">s3://my-data-bucket</span></code>and set the relevant access credentials as environmental
variables (e.g. for AWS S3 you can use <code class="docutils literal notranslate"><span class="pre">AWS_ACCESS_KEY_ID</span></code> and
<code class="docutils literal notranslate"><span class="pre">AWS_SECRET_ACCESS_KEY</span></code>).</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="s1">&#39;s3://altinity-clickhouse-data/nyc_taxi_rides/data/tripdata_parquet/&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1310903963</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="#create-external-table"><code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">EXTERNAL</span> <span class="pre">TABLE</span></code></a> section below for
additional configuration options.</p>
</section>
<section id="create-external-table">
<h1><code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">EXTERNAL</span> <span class="pre">TABLE</span></code><a class="headerlink" href="#create-external-table" title="Link to this heading">¶</a></h1>
<p>It is also possible to create a table backed by files or remote locations via
<code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">EXTERNAL</span> <span class="pre">TABLE</span></code> as shown below. Note that DataFusion does not support
wildcards (e.g. <code class="docutils literal notranslate"><span class="pre">*</span></code>) in file paths; instead, specify the directory path directly
to read all compatible files in that directory.</p>
<p>For example, to create a table <code class="docutils literal notranslate"><span class="pre">hits</span></code> backed by a local parquet file named <code class="docutils literal notranslate"><span class="pre">hits.parquet</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">hits</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;hits.parquet&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>To create a table <code class="docutils literal notranslate"><span class="pre">hits</span></code> backed by a remote parquet file via HTTP(S):</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">hits</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;https://datasets.clickhouse.com/hits_compatible/athena_partitioned/hits_1.parquet&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>In both cases, <code class="docutils literal notranslate"><span class="pre">hits</span></code> now can be queried as a regular table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">hits</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1000000</span><span class="w">  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="mi">1</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="p">.</span><span class="w"> </span><span class="n">Query</span><span class="w"> </span><span class="n">took</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">344</span><span class="w"> </span><span class="n">seconds</span><span class="p">.</span>
</pre></div>
</div>
<p><strong>Why Wildcards Are Not Supported</strong></p>
<p>Although wildcards (e.g., <em>.parquet or **/</em>.parquet) may work for local
filesystems in some cases, they are not supported by DataFusion CLI. This
is because wildcards are not universally applicable across all storage backends
(e.g., S3, GCS). Instead, DataFusion expects the user to specify the directory
path, and it will automatically read all compatible files within that directory.</p>
<p>For example, the following usage is not supported:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">message</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="k">day</span><span class="w"> </span><span class="nb">DATE</span>
<span class="p">)</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;gs://bucket/*.parquet&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>Instead, you should use:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">message</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="k">day</span><span class="w"> </span><span class="nb">DATE</span>
<span class="p">)</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;gs://bucket/my_table/&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="formats">
<h1>Formats<a class="headerlink" href="#formats" title="Link to this heading">¶</a></h1>
<section id="parquet">
<h2>Parquet<a class="headerlink" href="#parquet" title="Link to this heading">¶</a></h2>
<p>The schema information for parquet will be derived automatically.</p>
<p>Register a single file parquet datasource</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">taxi</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;/mnt/nyctaxi/tripdata.parquet&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>Register a single folder parquet datasource. Note: All files inside must be valid
parquet files and have compatible schemas</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple myst">
<dt>Paths must end in Slash <code class="docutils literal notranslate"><span class="pre">/</span></code></dt><dd><p>The path must end in <code class="docutils literal notranslate"><span class="pre">/</span></code> otherwise DataFusion will treat the path as a file and not a directory</p>
</dd>
</dl>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">taxi</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;/mnt/nyctaxi/&#39;</span><span class="p">;</span>
</pre></div>
</div>
<section id="parquet-specific-options">
<h3>Parquet Specific Options<a class="headerlink" href="#parquet-specific-options" title="Link to this heading">¶</a></h3>
<p>You can specify additional options for parquet files using the <code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code> clause.
For example, to read and write a parquet directory with encryption settings you could use:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">encrypted_parquet_table</span>
<span class="p">(</span>
<span class="n">double_field</span><span class="w"> </span><span class="n">double</span><span class="p">,</span>
<span class="n">float_field</span><span class="w"> </span><span class="nb">float</span>
<span class="p">)</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span><span class="w"> </span><span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;pq/&#39;</span><span class="w"> </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="c1">-- encryption</span>
<span class="w">    </span><span class="s1">&#39;format.crypto.file_encryption.encrypt_footer&#39;</span><span class="w"> </span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;format.crypto.file_encryption.footer_key_as_hex&#39;</span><span class="w"> </span><span class="s1">&#39;30313233343536373839303132333435&#39;</span><span class="p">,</span><span class="w">  </span><span class="c1">-- b&quot;0123456789012345&quot;</span>
<span class="w">    </span><span class="s1">&#39;format.crypto.file_encryption.column_key_as_hex::double_field&#39;</span><span class="w"> </span><span class="s1">&#39;31323334353637383930313233343530&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- b&quot;1234567890123450&quot;</span>
<span class="w">    </span><span class="s1">&#39;format.crypto.file_encryption.column_key_as_hex::float_field&#39;</span><span class="w"> </span><span class="s1">&#39;31323334353637383930313233343531&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- b&quot;1234567890123451&quot;</span>
<span class="w">    </span><span class="c1">-- decryption</span>
<span class="w">    </span><span class="s1">&#39;format.crypto.file_decryption.footer_key_as_hex&#39;</span><span class="w"> </span><span class="s1">&#39;30313233343536373839303132333435&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- b&quot;0123456789012345&quot;</span>
<span class="w">    </span><span class="s1">&#39;format.crypto.file_decryption.column_key_as_hex::double_field&#39;</span><span class="w"> </span><span class="s1">&#39;31323334353637383930313233343530&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- b&quot;1234567890123450&quot;</span>
<span class="w">    </span><span class="s1">&#39;format.crypto.file_decryption.column_key_as_hex::float_field&#39;</span><span class="w"> </span><span class="s1">&#39;31323334353637383930313233343531&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- b&quot;1234567890123451&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Here the keys are specified in hexadecimal format because they are binary data. These can be encoded in SQL using:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;0123456789012345&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;hex&#39;</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm">+----------------------------------------------+</span>
<span class="cm">| encode(Utf8(&quot;0123456789012345&quot;),Utf8(&quot;hex&quot;)) |</span>
<span class="cm">+----------------------------------------------+</span>
<span class="cm">| 30313233343536373839303132333435             |</span>
<span class="cm">+----------------------------------------------+</span>
<span class="cm">*/</span>
</pre></div>
</div>
<p>For more details on the available options, refer to the Rust
<a class="reference external" href="https://docs.rs/datafusion/latest/datafusion/common/config/struct.TableParquetOptions.html">TableParquetOptions</a>
documentation in DataFusion.</p>
</section>
</section>
<section id="csv">
<h2>CSV<a class="headerlink" href="#csv" title="Link to this heading">¶</a></h2>
<p>DataFusion will infer the CSV schema automatically or you can provide it explicitly.</p>
<p>Register a single file csv datasource with a header row:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CSV</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;/path/to/aggregate_test_100.csv&#39;</span>
<span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;has_header&#39;</span><span class="w"> </span><span class="s1">&#39;true&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Register a single file csv datasource with explicitly defined schema:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">c1</span><span class="w">  </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">c2</span><span class="w">  </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">c3</span><span class="w">  </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">c4</span><span class="w">  </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">c5</span><span class="w">  </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">c6</span><span class="w">  </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">c7</span><span class="w">  </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">c8</span><span class="w">  </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">c9</span><span class="w">  </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">c10</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">c11</span><span class="w"> </span><span class="nb">FLOAT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">c12</span><span class="w"> </span><span class="n">DOUBLE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">c13</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
<span class="p">)</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CSV</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;/path/to/aggregate_test_100.csv&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
</section>
<section id="locations">
<h1>Locations<a class="headerlink" href="#locations" title="Link to this heading">¶</a></h1>
<section id="http-s">
<h2>HTTP(s)<a class="headerlink" href="#http-s" title="Link to this heading">¶</a></h2>
<p>To read from a remote parquet file via HTTP(S):</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">hits</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;https://datasets.clickhouse.com/hits_compatible/athena_partitioned/hits_1.parquet&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="s3">
<h2>S3<a class="headerlink" href="#s3" title="Link to this heading">¶</a></h2>
<p>DataFusion CLI supports configuring <a class="reference external" href="https://aws.amazon.com/s3/">AWS S3</a> via the
<code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">EXTERNAL</span> <span class="pre">TABLE</span></code> statement and standard AWS configuration methods (via the
<a class="reference external" href="https://docs.rs/aws-config/latest/aws_config/"><code class="docutils literal notranslate"><span class="pre">aws-config</span></code></a> AWS SDK crate).</p>
<p>To create an external table from a file in an S3 bucket with explicit
credentials:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span>
<span class="k">OPTIONS</span><span class="p">(</span>
<span class="w">    </span><span class="s1">&#39;aws.access_key_id&#39;</span><span class="w"> </span><span class="s1">&#39;******&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;aws.secret_access_key&#39;</span><span class="w"> </span><span class="s1">&#39;******&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;aws.region&#39;</span><span class="w"> </span><span class="s1">&#39;us-east-2&#39;</span>
<span class="p">)</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;s3://bucket/path/file.parquet&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>To create an external table using environment variables:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">AWS_DEFAULT_REGION</span><span class="o">=</span>us-east-2
$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span>******
$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=</span>******

$<span class="w"> </span>datafusion-cli
<span class="sb">`</span>datafusion-cli<span class="w"> </span>v21.0.0
&gt;<span class="w"> </span>create<span class="w"> </span>CREATE<span class="w"> </span>TABLE<span class="w"> </span><span class="nb">test</span><span class="w"> </span>STORED<span class="w"> </span>AS<span class="w"> </span>PARQUET<span class="w"> </span>LOCATION<span class="w"> </span><span class="s1">&#39;s3://bucket/path/file.parquet&#39;</span><span class="p">;</span>
<span class="m">0</span><span class="w"> </span>rows<span class="w"> </span><span class="k">in</span><span class="w"> </span>set.<span class="w"> </span>Query<span class="w"> </span>took<span class="w"> </span><span class="m">0</span>.374<span class="w"> </span>seconds.
&gt;<span class="w"> </span><span class="k">select</span><span class="w"> </span>*<span class="w"> </span>from<span class="w"> </span>test<span class="p">;</span>
+----------+----------+
<span class="p">|</span><span class="w"> </span>column_1<span class="w"> </span><span class="p">|</span><span class="w"> </span>column_2<span class="w"> </span><span class="p">|</span>
+----------+----------+
<span class="p">|</span><span class="w"> </span><span class="m">1</span><span class="w">        </span><span class="p">|</span><span class="w"> </span><span class="m">2</span><span class="w">        </span><span class="p">|</span>
+----------+----------+
<span class="m">1</span><span class="w"> </span>row<span class="w"> </span><span class="k">in</span><span class="w"> </span>set.<span class="w"> </span>Query<span class="w"> </span>took<span class="w"> </span><span class="m">0</span>.171<span class="w"> </span>seconds.
</pre></div>
</div>
<p>To read from a public S3 bucket without signatures, use the
<code class="docutils literal notranslate"><span class="pre">aws.SKIP_SIGNATURE</span></code> option:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nyc_taxi_rides</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span><span class="w"> </span><span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;s3://altinity-clickhouse-data/nyc_taxi_rides/data/tripdata_parquet/&#39;</span>
<span class="k">OPTIONS</span><span class="p">(</span><span class="n">aws</span><span class="p">.</span><span class="n">SKIP_SIGNATURE</span><span class="w"> </span><span class="k">true</span><span class="p">);</span>
</pre></div>
</div>
<p>Credentials are taken in this order of precedence:</p>
<ol class="arabic simple">
<li><p>Explicitly specified in the <code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code> clause of the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">EXTERNAL</span> <span class="pre">TABLE</span></code> statement.</p></li>
<li><p>Determined by <a class="reference external" href="https://docs.rs/aws-config/latest/aws_config/"><code class="docutils literal notranslate"><span class="pre">aws-config</span></code></a> crate (standard environment variables such as <code class="docutils literal notranslate"><span class="pre">AWS_ACCESS_KEY_ID</span></code> and <code class="docutils literal notranslate"><span class="pre">AWS_SECRET_ACCESS_KEY</span></code> as well as other AWS specific features).</p></li>
</ol>
<p>If no credentials are specified, DataFusion CLI will use unsigned requests to S3,
which allows reading from public buckets.</p>
<p>Supported configuration options are:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Environment Variable</p></th>
<th class="head"><p>Configuration Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">AWS_ACCESS_KEY_ID</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws.access_key_id</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">AWS_SECRET_ACCESS_KEY</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws.secret_access_key</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">AWS_DEFAULT_REGION</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws.region</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">AWS_ENDPOINT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws.endpoint</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">AWS_SESSION_TOKEN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws.token</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">AWS_CONTAINER_CREDENTIALS_RELATIVE_URI</span></code></p></td>
<td><p></p></td>
<td><p>See <a class="reference external" href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-iam-roles.html">IAM Roles</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">AWS_ALLOW_HTTP</span></code></p></td>
<td><p></p></td>
<td><p>If “true”, permit HTTP connections without TLS</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">AWS_SKIP_SIGNATURE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws.skip_signature</span></code></p></td>
<td><p>If “true”, does not sign requests</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws.nosign</span></code></p></td>
<td><p>Alias for <code class="docutils literal notranslate"><span class="pre">skip_signature</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="oss">
<h2>OSS<a class="headerlink" href="#oss" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://www.alibabacloud.com/product/object-storage-service">Alibaba cloud OSS</a> data sources must have connection credentials configured</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span>
<span class="k">OPTIONS</span><span class="p">(</span>
<span class="w">    </span><span class="s1">&#39;aws.access_key_id&#39;</span><span class="w"> </span><span class="s1">&#39;******&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;aws.secret_access_key&#39;</span><span class="w"> </span><span class="s1">&#39;******&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;aws.oss.endpoint&#39;</span><span class="w"> </span><span class="s1">&#39;https://bucket.oss-cn-hangzhou.aliyuncs.com&#39;</span>
<span class="p">)</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;oss://bucket/path/file.parquet&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>The supported OPTIONS are</p>
<ul class="simple">
<li><p>access_key_id</p></li>
<li><p>secret_access_key</p></li>
<li><p>endpoint</p></li>
</ul>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">endpoint</span></code> format of oss needs to be: <code class="docutils literal notranslate"><span class="pre">https://{bucket}.{oss-region-endpoint}</span></code></p>
</section>
<section id="cos">
<h2>COS<a class="headerlink" href="#cos" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://cloud.tencent.com/product/cos">Tencent cloud COS</a> data sources data sources must have connection credentials configured</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span>
<span class="k">OPTIONS</span><span class="p">(</span>
<span class="w">    </span><span class="s1">&#39;aws.access_key_id&#39;</span><span class="w"> </span><span class="s1">&#39;******&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;aws.secret_access_key&#39;</span><span class="w"> </span><span class="s1">&#39;******&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;aws.cos.endpoint&#39;</span><span class="w"> </span><span class="s1">&#39;https://cos.ap-singapore.myqcloud.com&#39;</span>
<span class="p">)</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;cos://bucket/path/file.parquet&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>The supported OPTIONS are:</p>
<ul class="simple">
<li><p>access_key_id</p></li>
<li><p>secret_access_key</p></li>
<li><p>endpoint</p></li>
</ul>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">endpoint</span></code> format of urls must be: <code class="docutils literal notranslate"><span class="pre">https://cos.{cos-region-endpoint}</span></code></p>
</section>
<section id="gcs">
<h2>GCS<a class="headerlink" href="#gcs" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://cloud.google.com/storage">Google Cloud Storage</a> data sources must have connection credentials configured</p>
<p>For example, to create an external table from a file in a GCS bucket</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span>
<span class="k">OPTIONS</span><span class="p">(</span>
<span class="w">    </span><span class="s1">&#39;gcp.service_account_path&#39;</span><span class="w"> </span><span class="s1">&#39;/tmp/gcs.json&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;gs://bucket/path/file.parquet&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>It is also possible to specify the access information using environment variables:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">GOOGLE_SERVICE_ACCOUNT</span><span class="o">=</span>/tmp/gcs.json

$<span class="w"> </span>datafusion-cli
DataFusion<span class="w"> </span>CLI<span class="w"> </span>v21.0.0
&gt;<span class="w"> </span>create<span class="w"> </span>external<span class="w"> </span>table<span class="w"> </span><span class="nb">test</span><span class="w"> </span>stored<span class="w"> </span>as<span class="w"> </span>parquet<span class="w"> </span>location<span class="w"> </span><span class="s1">&#39;gs://bucket/path/file.parquet&#39;</span><span class="p">;</span>
<span class="m">0</span><span class="w"> </span>rows<span class="w"> </span><span class="k">in</span><span class="w"> </span>set.<span class="w"> </span>Query<span class="w"> </span>took<span class="w"> </span><span class="m">0</span>.374<span class="w"> </span>seconds.
&gt;<span class="w"> </span><span class="k">select</span><span class="w"> </span>*<span class="w"> </span>from<span class="w"> </span>test<span class="p">;</span>
+----------+----------+
<span class="p">|</span><span class="w"> </span>column_1<span class="w"> </span><span class="p">|</span><span class="w"> </span>column_2<span class="w"> </span><span class="p">|</span>
+----------+----------+
<span class="p">|</span><span class="w"> </span><span class="m">1</span><span class="w">        </span><span class="p">|</span><span class="w"> </span><span class="m">2</span><span class="w">        </span><span class="p">|</span>
+----------+----------+
<span class="m">1</span><span class="w"> </span>row<span class="w"> </span><span class="k">in</span><span class="w"> </span>set.<span class="w"> </span>Query<span class="w"> </span>took<span class="w"> </span><span class="m">0</span>.171<span class="w"> </span>seconds.
</pre></div>
</div>
<p>Supported configuration options are:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Environment Variable</p></th>
<th class="head"><p>Configuration Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">GOOGLE_SERVICE_ACCOUNT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">gcp.service_account_path</span></code></p></td>
<td><p>location of service account file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">GOOGLE_SERVICE_ACCOUNT_PATH</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">gcp.service_account_path</span></code></p></td>
<td><p>(alias) location of service account file</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SERVICE_ACCOUNT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">gcp.service_account_path</span></code></p></td>
<td><p>(alias) location of service account file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">GOOGLE_SERVICE_ACCOUNT_KEY</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">gcp.service_account_key</span></code></p></td>
<td><p>JSON serialized service account key</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">GOOGLE_APPLICATION_CREDENTIALS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">gcp.application_credentials_path</span></code></p></td>
<td><p>location of application credentials file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">GOOGLE_BUCKET</span></code></p></td>
<td><p></p></td>
<td><p>bucket name</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">GOOGLE_BUCKET_NAME</span></code></p></td>
<td><p></p></td>
<td><p>(alias) bucket name</p></td>
</tr>
</tbody>
</table>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="usage.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Usage</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../dataframe.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">DataFrame API</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  
<!-- Based on pydata_sphinx_theme/footer.html -->
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2019-2025, Apache Software Foundation.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 8.2.3.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p>Apache DataFusion, Apache, the Apache feather logo, and the Apache DataFusion project logo</p>
      <p>are either registered trademarks or trademarks of The Apache Software Foundation in the United States and other countries.</p>
    </div>
  </div>
</footer>


  </body>
</html>