<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Reading Explain Plans &#8212; Apache DataFusion  documentation</title>
    
    <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/pydata-sphinx-theme.css?v=1140d252" />
    <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css?v=c6d785ac" />
    
    <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script src="../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Frequently Asked Questions" href="faq.html" />
    <link rel="prev" title="Configuration Settings" href="configs.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    


    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items">

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  ASF Links
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://apache.org">
   Apache Software Foundation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.apache.org/licenses/">
   License
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.apache.org/foundation/sponsorship.html">
   Donate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.apache.org/foundation/thanks.html">
   Thanks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.apache.org/security/">
   Security
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Links
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/apache/datafusion">
   GitHub and Issue Tracker
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://crates.io/crates/datafusion">
   crates.io
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.rs/datafusion/latest/datafusion/">
   API Docs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://datafusion.apache.org/blog/">
   Blog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/apache/datafusion/blob/main/CODE_OF_CONDUCT.md">
   Code of conduct
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../download.html">
   Download
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  User Guide
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="example-usage.html">
   Example Usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="features.html">
   Features
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="concepts-readings-events.html">
   Concepts, Readings, Events
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="crate-configuration.html">
   Crate Configuration
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="cli/index.html">
   DataFusion CLI
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="cli/overview.html">
     Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cli/installation.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cli/usage.html">
     Usage
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cli/datasources.html">
     Local Files / Directories
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dataframe.html">
   DataFrame API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="expressions.html">
   Expression API
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="sql/index.html">
   SQL Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/data_types.html">
     Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/select.html">
     SELECT syntax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/subqueries.html">
     Subqueries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/ddl.html">
     DDL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/dml.html">
     DML
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/explain.html">
     EXPLAIN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/information_schema.html">
     Information Schema
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/operators.html">
     Operators and Literals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/aggregate_functions.html">
     Aggregate Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/window_functions.html">
     Window Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/scalar_functions.html">
     Scalar Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/special_functions.html">
     Special Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/write_options.html">
     Write Options
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sql/prepared_statements.html">
     Prepared Statements
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="configs.html">
   Configuration Settings
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Reading Explain Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="faq.html">
   Frequently Asked Questions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Library User Guide
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/index.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/extensions.html">
   Extensions List
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/using-the-sql-api.html">
   Using the SQL API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/working-with-exprs.html">
   Working with
   <code class="docutils literal notranslate">
    <span class="pre">
     Expr
    </span>
   </code>
   s
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/using-the-dataframe-api.html">
   Using the DataFrame API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/building-logical-plans.html">
   Building Logical Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/catalogs.html">
   Catalogs, Schemas, and Tables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/adding-udfs.html">
   Adding User Defined Functions: Scalar/Window/Aggregate/Table Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/custom-table-providers.html">
   Custom Table Provider
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/extending-operators.html">
   Extending DataFusion’s operators: custom LogicalPlan and Execution Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/profiling.html">
   Profiling Cookbook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/query-optimizer.html">
   DataFusion Query Optimizer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../library-user-guide/upgrading.html">
   Upgrade Guides
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contributor Guide
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../contributor-guide/index.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributor-guide/communication.html">
   Communication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributor-guide/development_environment.html">
   Development Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributor-guide/architecture.html">
   Architecture
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributor-guide/testing.html">
   Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributor-guide/api-health.html">
   API health policy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributor-guide/howtos.html">
   HOWTOs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributor-guide/roadmap.html">
   Roadmap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributor-guide/governance.html">
   Governance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributor-guide/inviting.html">
   Inviting New Committers and PMC Members
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../contributor-guide/specification/index.html">
   Specifications
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../contributor-guide/specification/invariants.html">
     Invariants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../contributor-guide/specification/output-field-name-semantic.html">
     Output field name semantics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributor-guide/gsoc_application_guidelines.html">
   GSoC Application Guidelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributor-guide/gsoc_project_ideas.html">
   GSoC Project Ideas
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  DataFusion Subprojects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://arrow.apache.org/ballista/">
   DataFusion Ballista
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://datafusion.apache.org/comet/">
   DataFusion Comet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://datafusion.apache.org/python/">
   DataFusion Python
  </a>
 </li>
</ul>

    
  </div>

  <a class="navbar-brand" href="../index.html">
    <img src="../_static/images/2x_bgwhite_original.png" class="logo" alt="logo">
  </a>
</nav>

              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-select-and-filter">
   Example: Select and filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#query-plans-are-trees">
   Query plans are trees
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#understanding-large-query-plans">
   Understanding large query plans
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#more-debugging-information-explain-verbose">
   More Debugging Information:
   <code class="docutils literal notranslate">
    <span class="pre">
     EXPLAIN
    </span>
    <span class="pre">
     VERBOSE
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#execution-counters-explain-analyze">
   Execution Counters:
   <code class="docutils literal notranslate">
    <span class="pre">
     EXPLAIN
    </span>
    <span class="pre">
     ANALYZE
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#partitions-and-execution">
   Partitions and Execution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-of-an-aggregate-query">
   Example of an Aggregate Query
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-in-this-example">
     Data in this Example
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/apache/arrow-datafusion/edit/main/docs/source/user-guide/explain-usage.md">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <!---
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License.
-->
<section id="reading-explain-plans">
<h1>Reading Explain Plans<a class="headerlink" href="#reading-explain-plans" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>This section describes of how to read a DataFusion query plan. While fully
comprehending all details of these plans requires significant expertise in the
DataFusion engine, this guide will help you get started with the basics.</p>
<p>Datafusion executes queries using a <code class="docutils literal notranslate"><span class="pre">query</span> <span class="pre">plan</span></code>. To see the plan without
running the query, add the keyword <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span></code> to your SQL query or call the
<a class="reference external" href="https://docs.rs/datafusion/latest/datafusion/dataframe/struct.DataFrame.html#method.explain">DataFrame::explain</a> method</p>
</section>
<section id="example-select-and-filter">
<h2>Example: Select and filter<a class="headerlink" href="#example-select-and-filter" title="Link to this heading">¶</a></h2>
<p>In this section, we run example queries against the <code class="docutils literal notranslate"><span class="pre">hits.parquet</span></code> file. See
<a class="reference internal" href="#data-in-this-example">below</a>) for information on how to get this file.</p>
<p>Let’s see how DataFusion runs a query that selects the top 5 watch lists for the
site <code class="docutils literal notranslate"><span class="pre">http://domcheloveplanet.ru/</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXPLAIN</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="ss">&quot;WatchID&quot;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">wid</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;hits.parquet&quot;</span><span class="p">.</span><span class="ss">&quot;ClientIP&quot;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip</span>
<span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;hits.parquet&#39;</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">starts_with</span><span class="p">(</span><span class="ss">&quot;URL&quot;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;http://domcheloveplanet.ru/&#39;</span><span class="p">)</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">wid</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="k">DESC</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
</pre></div>
</div>
<p>The output will look like</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                      |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: wid ASC NULLS LAST, ip DESC NULLS FIRST, fetch=5                                                                                                                                                    |
|               |   Projection: hits.parquet.WatchID AS wid, hits.parquet.ClientIP AS ip                                                                                                                                    |
|               |     Filter: starts_with(hits.parquet.URL, Utf8(&quot;http://domcheloveplanet.ru/&quot;))                                                                                                                            |
|               |       TableScan: hits.parquet projection=[WatchID, ClientIP, URL], partial_filters=[starts_with(hits.parquet.URL, Utf8(&quot;http://domcheloveplanet.ru/&quot;))]                                                   |
| physical_plan | SortPreservingMergeExec: [wid@0 ASC NULLS LAST,ip@1 DESC], fetch=5                                                                                                                                        |
|               |   SortExec: TopK(fetch=5), expr=[wid@0 ASC NULLS LAST,ip@1 DESC], preserve_partitioning=[true]                                                                                                            |
|               |     ProjectionExec: expr=[WatchID@0 as wid, ClientIP@1 as ip]                                                                                                                                             |
|               |       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                         |
|               |         FilterExec: starts_with(URL@2, http://domcheloveplanet.ru/)                                                                                                                                       |
|               |           DataSourceExec: file_groups={16 groups: [[hits.parquet:0..923748528], ...]}, projection=[WatchID, ClientIP, URL], predicate=starts_with(URL@13, http://domcheloveplanet.ru/), file_type=parquet |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 row(s) fetched.
Elapsed 0.060 seconds.
</pre></div>
</div>
<p>There are two sections: logical plan and physical plan</p>
<ul class="simple">
<li><p><strong>Logical Plan:</strong> is a plan generated for a specific SQL query, DataFrame, or other language without the
knowledge of the underlying data organization.</p></li>
<li><p><strong>Physical Plan:</strong> is a plan generated from a logical plan along with consideration of the hardware
configuration (e.g number of CPUs) and the underlying data organization (e.g number of files).
This physical plan is specific to your hardware configuration and your data. If you load the same
data to different hardware with different configurations, the same query may generate different query plans.</p></li>
</ul>
<p>Understanding a query plan can help to you understand its performance. For example, when the plan shows your query reads
many files, it signals you to either add more filter in the query to read less data or to modify your file
design to make fewer but larger files. This document focuses on how to read a query plan. How to make a
query run faster depends on the reason it is slow and beyond the scope of this document.</p>
</section>
<section id="query-plans-are-trees">
<h2>Query plans are trees<a class="headerlink" href="#query-plans-are-trees" title="Link to this heading">¶</a></h2>
<p>A query plan is an upside down tree, and we always read from bottom up. The
physical plan in Figure 1 in tree format will look like</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                         ▲
                         │
                         │
┌─────────────────────────────────────────────────┐
│             SortPreservingMergeExec             │
│        [wid@0 ASC NULLS LAST,ip@1 DESC]         │
│                     fetch=5                     │
└─────────────────────────────────────────────────┘
                         ▲
                         │
┌─────────────────────────────────────────────────┐
│             SortExec TopK(fetch=5),             │
│     expr=[wid@0 ASC NULLS LAST,ip@1 DESC],      │
│           preserve_partitioning=[true]          │
└─────────────────────────────────────────────────┘
                         ▲
                         │
┌─────────────────────────────────────────────────┐
│                 ProjectionExec                  │
│    expr=[WatchID@0 as wid, ClientIP@1 as ip]    │
└─────────────────────────────────────────────────┘
                         ▲
                         │
┌─────────────────────────────────────────────────┐
│               CoalesceBatchesExec               │
└─────────────────────────────────────────────────┘
                         ▲
                         │
┌─────────────────────────────────────────────────┐
│                   FilterExec                    │
│ starts_with(URL@2, http://domcheloveplanet.ru/) │
└─────────────────────────────────────────────────┘
                         ▲
                         │
┌────────────────────────────────────────────────┐
│                  DataSourceExec                │
│          hits.parquet (filter = ...)           │
└────────────────────────────────────────────────┘
</pre></div>
</div>
<p>Each node in the tree/plan ends with <code class="docutils literal notranslate"><span class="pre">Exec</span></code> and is sometimes also called an <code class="docutils literal notranslate"><span class="pre">operator</span></code> or <code class="docutils literal notranslate"><span class="pre">ExecutionPlan</span></code> where data is
processed, transformed and sent up.</p>
<ol class="arabic simple">
<li><p>First, data in parquet the <code class="docutils literal notranslate"><span class="pre">hits.parquet</span></code> file us read in parallel using 16 cores in 16 “partitions” (more on this later) from <code class="docutils literal notranslate"><span class="pre">DataSourceExec</span></code>, which applies a first pass at filtering during the scan.</p></li>
<li><p>Next, the output is filtered using <code class="docutils literal notranslate"><span class="pre">FilterExec</span></code> to ensure only rows where <code class="docutils literal notranslate"><span class="pre">starts_with(URL,</span> <span class="pre">'http://domcheloveplanet.ru/')</span></code> evaluates to true are passed on</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">CoalesceBatchesExec</span></code> then ensures that the data is grouped into larger batches for processing</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">ProjectionExec</span></code> then projects the data to rename the <code class="docutils literal notranslate"><span class="pre">WatchID</span></code> and <code class="docutils literal notranslate"><span class="pre">ClientIP</span></code> columns to <code class="docutils literal notranslate"><span class="pre">wid</span></code> and <code class="docutils literal notranslate"><span class="pre">ip</span></code> respectively.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">SortExec</span></code> then sorts the data by <code class="docutils literal notranslate"><span class="pre">wid</span> <span class="pre">ASC,</span> <span class="pre">ip</span> <span class="pre">DESC</span></code>. The <code class="docutils literal notranslate"><span class="pre">Topk(fetch=5)</span></code> indicates that a special implementation is used that only tracks and emits the top 5 values in each partition.</p></li>
<li><p>Finally the <code class="docutils literal notranslate"><span class="pre">SortPreservingMergeExec</span></code> merges the sorted data from all partitions and returns the top 5 rows overall.</p></li>
</ol>
</section>
<section id="understanding-large-query-plans">
<h2>Understanding large query plans<a class="headerlink" href="#understanding-large-query-plans" title="Link to this heading">¶</a></h2>
<p>A large query plan may look intimidating, but you can quickly understand what it does by following these steps</p>
<ol class="arabic simple">
<li><p>As always, read from bottom up, one operator at a time.</p></li>
<li><p>Understand the job of this operator by reading
the <a class="reference external" href="https://docs.rs/datafusion/latest/datafusion/physical_plan/index.html">Physical Plan documentation</a>.</p></li>
<li><p>Understand the input data of the operator and how large/small it may be.</p></li>
<li><p>Understand how much data that operator produces and what it would look like.</p></li>
</ol>
<p>If you can answer those questions, you will be able to estimate how much work
that plan has to do and thus how long it will take. However, the <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span></code> just
shows you the plan without executing it.</p>
<p>If you want to know more about how much work each operator in query plan does,
you can use the <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span> <span class="pre">ANALYZE</span></code> to get the explain with runtime added (see
next section)</p>
</section>
<section id="more-debugging-information-explain-verbose">
<h2>More Debugging Information: <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span> <span class="pre">VERBOSE</span></code><a class="headerlink" href="#more-debugging-information-explain-verbose" title="Link to this heading">¶</a></h2>
<p>If the plan has to read too many files, not all of them will be shown in the
<code class="docutils literal notranslate"><span class="pre">EXPLAIN</span></code>. To see them, use <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span> <span class="pre">VEBOSE</span></code>. Like <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span></code>, <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span> <span class="pre">VERBOSE</span></code>
does not run the query. Instead it shows the full explain plan, with information
that is omitted from the default explain, as well as all intermediate physical
plans DataFusion generates before returning. This mode can be very helpful for
debugging to see why and when DataFusion added and removed operators from a plan.</p>
</section>
<section id="execution-counters-explain-analyze">
<h2>Execution Counters: <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span> <span class="pre">ANALYZE</span></code><a class="headerlink" href="#execution-counters-explain-analyze" title="Link to this heading">¶</a></h2>
<p>During execution, DataFusion operators collect detailed metrics. You can access
them programmatically via <a class="reference external" href="https://docs.rs/datafusion/latest/datafusion/physical_plan/trait.ExecutionPlan.html#method.metrics"><code class="docutils literal notranslate"><span class="pre">ExecutionPlan::metrics</span></code></a> as well as with the
<code class="docutils literal notranslate"><span class="pre">EXPLAIN</span> <span class="pre">ANALYZE</span></code> command. For example here is the same query query as
above but with <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span> <span class="pre">ANALYZE</span></code> (note the output is edited for clarity)</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="k">EXPLAIN</span><span class="w"> </span><span class="k">ANALYZE</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="ss">&quot;WatchID&quot;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">wid</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;hits.parquet&quot;</span><span class="p">.</span><span class="ss">&quot;ClientIP&quot;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip</span>
<span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;hits.parquet&#39;</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">starts_with</span><span class="p">(</span><span class="ss">&quot;URL&quot;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;http://domcheloveplanet.ru/&#39;</span><span class="p">)</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">wid</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="k">DESC</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">plan_type</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="n">plan</span><span class="w">                                                                                                                                                                                                                                                                                                                                                           </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">Metrics</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SortPreservingMergeExec</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">wid</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="k">ASC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">LAST</span><span class="p">,</span><span class="n">ip</span><span class="o">@</span><span class="mi">1</span><span class="w"> </span><span class="k">DESC</span><span class="p">],</span><span class="w"> </span><span class="k">fetch</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">output_rows</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed_compute</span><span class="o">=</span><span class="mi">2</span><span class="p">.</span><span class="mi">375</span><span class="err">µ</span><span class="n">s</span><span class="p">]</span><span class="w">                                                                                                                                                                                                                                           </span><span class="o">|</span>
<span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w">   </span><span class="n">SortExec</span><span class="p">:</span><span class="w"> </span><span class="n">TopK</span><span class="p">(</span><span class="k">fetch</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="n">expr</span><span class="o">=</span><span class="p">[</span><span class="n">wid</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="k">ASC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">LAST</span><span class="p">,</span><span class="n">ip</span><span class="o">@</span><span class="mi">1</span><span class="w"> </span><span class="k">DESC</span><span class="p">],</span><span class="w"> </span><span class="n">preserve_partitioning</span><span class="o">=</span><span class="p">[</span><span class="k">true</span><span class="p">],</span><span class="w"> </span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">output_rows</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed_compute</span><span class="o">=</span><span class="mi">7</span><span class="p">.</span><span class="mi">243038</span><span class="n">ms</span><span class="p">,</span><span class="w"> </span><span class="n">row_replacements</span><span class="o">=</span><span class="mi">482</span><span class="p">]</span><span class="w">                                                                                                                                                                                     </span><span class="o">|</span>
<span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w">     </span><span class="n">ProjectionExec</span><span class="p">:</span><span class="w"> </span><span class="n">expr</span><span class="o">=</span><span class="p">[</span><span class="n">WatchID</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">wid</span><span class="p">,</span><span class="w"> </span><span class="n">ClientIP</span><span class="o">@</span><span class="mi">1</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ip</span><span class="p">],</span><span class="w"> </span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">output_rows</span><span class="o">=</span><span class="mi">811821</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed_compute</span><span class="o">=</span><span class="mi">66</span><span class="p">.</span><span class="mi">25</span><span class="err">µ</span><span class="n">s</span><span class="p">]</span><span class="w">                                                                                                                                                                                                                                           </span><span class="o">|</span>
<span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w">         </span><span class="n">FilterExec</span><span class="p">:</span><span class="w"> </span><span class="n">starts_with</span><span class="p">(</span><span class="n">URL</span><span class="o">@</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">domcheloveplanet</span><span class="p">.</span><span class="n">ru</span><span class="o">/</span><span class="p">),</span><span class="w"> </span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">output_rows</span><span class="o">=</span><span class="mi">811821</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed_compute</span><span class="o">=</span><span class="mi">1</span><span class="p">.</span><span class="mi">36923816</span><span class="n">s</span><span class="p">]</span><span class="w">                                                                                                                                                                                                                                 </span><span class="o">|</span>
<span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w">           </span><span class="n">DataSourceExec</span><span class="p">:</span><span class="w"> </span><span class="n">file_groups</span><span class="o">=</span><span class="err">{</span><span class="mi">16</span><span class="w"> </span><span class="n">groups</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="n">hits</span><span class="p">.</span><span class="n">parquet</span><span class="p">:</span><span class="mi">0</span><span class="p">..</span><span class="mi">923748528</span><span class="p">],</span><span class="w"> </span><span class="p">...]</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="p">[</span><span class="n">WatchID</span><span class="p">,</span><span class="w"> </span><span class="n">ClientIP</span><span class="p">,</span><span class="w"> </span><span class="n">URL</span><span class="p">],</span><span class="w"> </span><span class="n">predicate</span><span class="o">=</span><span class="n">starts_with</span><span class="p">(</span><span class="n">URL</span><span class="o">@</span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">domcheloveplanet</span><span class="p">.</span><span class="n">ru</span><span class="o">/</span><span class="p">),</span><span class="w"> </span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">output_rows</span><span class="o">=</span><span class="mi">99997497</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed_compute</span><span class="o">=</span><span class="mi">16</span><span class="n">ns</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="n">bytes_scanned</span><span class="o">=</span><span class="mi">3703192723</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w">  </span><span class="n">time_elapsed_opening</span><span class="o">=</span><span class="mi">308</span><span class="p">.</span><span class="mi">203002</span><span class="n">ms</span><span class="p">,</span><span class="w"> </span><span class="n">time_elapsed_scanning_total</span><span class="o">=</span><span class="mi">8</span><span class="p">.</span><span class="mi">350342183</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="p">...]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="mi">1</span><span class="w"> </span><span class="k">row</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">fetched</span><span class="p">.</span>
<span class="n">Elapsed</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">720</span><span class="w"> </span><span class="n">seconds</span><span class="p">.</span>
</pre></div>
</div>
<p>In this case, DataFusion actually ran the query, but discarded any results, and
instead returned an annotated plan with a new field, <code class="docutils literal notranslate"><span class="pre">metrics=[...]</span></code></p>
<p>Most operators have the common metrics <code class="docutils literal notranslate"><span class="pre">output_rows</span></code> and <code class="docutils literal notranslate"><span class="pre">elapsed_compute</span></code> and
some have operator specific metrics such as <code class="docutils literal notranslate"><span class="pre">DataSourceExec</span></code> with <code class="docutils literal notranslate"><span class="pre">ParquetSource</span></code> which has
<code class="docutils literal notranslate"><span class="pre">bytes_scanned=3703192723</span></code>. Note that times and counters are reported across all
cores, so if you have 16 cores, the time reported is the sum of the time taken
by all 16 cores.</p>
<p>Again, reading from bottom up:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DataSourceExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">output_rows=99997497</span></code>: A total 99.9M rows were produced</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bytes_scanned=3703192723</span></code>: Of the 14GB file, 3.7GB were actually read (due to projection pushdown)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time_elapsed_opening=308.203002ms</span></code>: It took 300ms to open the file and prepare to read it</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time_elapsed_scanning_total=8.350342183s</span></code>: It took 8.3 seconds of CPU time (across 16 cores) to actually decode the parquet data</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">FilterExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">output_rows=811821</span></code>: Of the 99.9M rows at its input, only 811K rows passed the filter and were produced at the output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">elapsed_compute=1.36923816s</span></code>: In total, 1.36s of CPU time (across 16 cores) was spend evaluating the filter</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CoalesceBatchesExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">output_rows=811821</span></code>, <code class="docutils literal notranslate"><span class="pre">elapsed_compute=12.873379ms</span></code>: Produced 811K rows in 13ms</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ProjectionExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">output_rows=811821,</span> <span class="pre">elapsed_compute=66.25µs</span></code>: Produced 811K rows in 66µs (microseconds). This projection is almost instantaneous as it does not manipulate any data</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">SortExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">output_rows=75</span></code>: Produced 75 rows in total. Each of 16 cores could produce up to 5 rows, but in this case not all cores did.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">elapsed_compute=7.243038ms</span></code>: 7ms was used to determine the top 5 rows</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">row_replacements=482</span></code>: Internally, the TopK operator updated its top list 482 times</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">SortPreservingMergeExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">output_rows=5</span></code>, <code class="docutils literal notranslate"><span class="pre">elapsed_compute=2.375µs</span></code>: Produced the final 5 rows in 2.375µs (microseconds)</p></li>
</ul>
</li>
</ul>
<p>When predicate pushdown is enabled, <code class="docutils literal notranslate"><span class="pre">DataSourceExec</span></code> with <code class="docutils literal notranslate"><span class="pre">ParquetSource</span></code> gains the following metrics:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">page_index_rows_matched</span></code>: number of rows in pages that were tested by a page index filter, and passed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">page_index_rows_pruned</span></code>: number of rows in pages that were tested by a page index filter, and did not pass</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">row_groups_matched_bloom_filter</span></code>: number of rows in row groups that were tested by a Bloom Filter, and passed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">row_groups_pruned_bloom_filter</span></code>: number of rows in row groups that were tested by a Bloom Filter, and did not pass</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">row_groups_matched_statistics</span></code>: number of rows in row groups that were tested by row group statistics (min and max value), and passed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">row_groups_pruned_statistics</span></code>: number of rows in row groups that were tested by row group statistics (min and max value), and did not pass</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pushdown_rows_matched</span></code>: rows that were tested by any of the above filtered, and passed all of them (this should be minimum of <code class="docutils literal notranslate"><span class="pre">page_index_rows_matched</span></code>, <code class="docutils literal notranslate"><span class="pre">row_groups_pruned_bloom_filter</span></code>, and <code class="docutils literal notranslate"><span class="pre">row_groups_pruned_statistics</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pushdown_rows_pruned</span></code>: rows that were tested by any of the above filtered, and did not pass one of them (this should be sum of <code class="docutils literal notranslate"><span class="pre">page_index_rows_matched</span></code>, <code class="docutils literal notranslate"><span class="pre">row_groups_pruned_bloom_filter</span></code>, and <code class="docutils literal notranslate"><span class="pre">row_groups_pruned_statistics</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predicate_evaluation_errors</span></code>: number of times evaluating the filter expression failed (expected to be zero in normal operation)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_predicate_creation_errors</span></code>: number of errors creating predicates (expected to be zero in normal operation)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bloom_filter_eval_time</span></code>: time spent parsing and evaluating Bloom Filters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">statistics_eval_time</span></code>: time spent parsing and evaluating row group-level statistics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">row_pushdown_eval_time</span></code>: time spent evaluating row-level filters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">page_index_eval_time</span></code>: time required to evaluate the page index filters</p></li>
</ul>
</section>
<section id="partitions-and-execution">
<h2>Partitions and Execution<a class="headerlink" href="#partitions-and-execution" title="Link to this heading">¶</a></h2>
<p>DataFusion determines the optimal number of cores to use as part of query
planning. Roughly speaking, each “partition” in the plan is run independently using
a separate core. Data crosses between cores only within certain operators such as
<code class="docutils literal notranslate"><span class="pre">RepartitionExec</span></code>, <code class="docutils literal notranslate"><span class="pre">CoalescePartitions</span></code> and <code class="docutils literal notranslate"><span class="pre">SortPreservingMergeExec</span></code></p>
<p>You can read more about this in the [Partitioning Docs].</p>
</section>
<section id="example-of-an-aggregate-query">
<h2>Example of an Aggregate Query<a class="headerlink" href="#example-of-an-aggregate-query" title="Link to this heading">¶</a></h2>
<p>Let us delve into an example query that aggregates data from the <code class="docutils literal notranslate"><span class="pre">hits.parquet</span></code>
file. For example, this query from ClickBench finds the top 10 users by their
number of hits:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="ss">&quot;UserID&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;hits.parquet&#39;</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="ss">&quot;UserID&quot;</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">DESC</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</pre></div>
</div>
<p>We can again see the query plan by using <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="k">EXPLAIN</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="ss">&quot;UserID&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;hits.parquet&#39;</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="ss">&quot;UserID&quot;</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">plan_type</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">plan</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">logical_plan</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="k">Limit</span><span class="p">:</span><span class="w"> </span><span class="n">skip</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">fetch</span><span class="o">=</span><span class="mi">10</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </span><span class="o">|</span>
<span class="o">|</span><span class="w">               </span><span class="o">|</span><span class="w">   </span><span class="n">Sort</span><span class="p">:</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">FIRST</span><span class="p">,</span><span class="w"> </span><span class="k">fetch</span><span class="o">=</span><span class="mi">10</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </span><span class="o">|</span>
<span class="o">|</span><span class="w">               </span><span class="o">|</span><span class="w">     </span><span class="k">Aggregate</span><span class="p">:</span><span class="w"> </span><span class="n">groupBy</span><span class="o">=</span><span class="p">[[</span><span class="n">hits</span><span class="p">.</span><span class="n">parquet</span><span class="p">.</span><span class="n">UserID</span><span class="p">]],</span><span class="w"> </span><span class="n">aggr</span><span class="o">=</span><span class="p">[[</span><span class="k">count</span><span class="p">(</span><span class="n">Int64</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)]]</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                              </span><span class="o">|</span>
<span class="o">|</span><span class="w">               </span><span class="o">|</span><span class="w">       </span><span class="n">TableScan</span><span class="p">:</span><span class="w"> </span><span class="n">hits</span><span class="p">.</span><span class="n">parquet</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="p">[</span><span class="n">UserID</span><span class="p">]</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">physical_plan</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">GlobalLimitExec</span><span class="p">:</span><span class="w"> </span><span class="n">skip</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">fetch</span><span class="o">=</span><span class="mi">10</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </span><span class="o">|</span>
<span class="o">|</span><span class="w">               </span><span class="o">|</span><span class="w">   </span><span class="n">SortPreservingMergeExec</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="o">@</span><span class="mi">1</span><span class="w"> </span><span class="k">DESC</span><span class="p">],</span><span class="w"> </span><span class="k">fetch</span><span class="o">=</span><span class="mi">10</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </span><span class="o">|</span>
<span class="o">|</span><span class="w">               </span><span class="o">|</span><span class="w">     </span><span class="n">SortExec</span><span class="p">:</span><span class="w"> </span><span class="n">TopK</span><span class="p">(</span><span class="k">fetch</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="n">expr</span><span class="o">=</span><span class="p">[</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="o">@</span><span class="mi">1</span><span class="w"> </span><span class="k">DESC</span><span class="p">],</span><span class="w"> </span><span class="n">preserve_partitioning</span><span class="o">=</span><span class="p">[</span><span class="k">true</span><span class="p">]</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                                </span><span class="o">|</span>
<span class="o">|</span><span class="w">               </span><span class="o">|</span><span class="w">       </span><span class="n">AggregateExec</span><span class="p">:</span><span class="w"> </span><span class="k">mode</span><span class="o">=</span><span class="n">FinalPartitioned</span><span class="p">,</span><span class="w"> </span><span class="n">gby</span><span class="o">=</span><span class="p">[</span><span class="n">UserID</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">UserID</span><span class="p">],</span><span class="w"> </span><span class="n">aggr</span><span class="o">=</span><span class="p">[</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)]</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                             </span><span class="o">|</span>
<span class="o">|</span><span class="w">               </span><span class="o">|</span><span class="w">         </span><span class="n">CoalesceBatchesExec</span><span class="p">:</span><span class="w"> </span><span class="n">target_batch_size</span><span class="o">=</span><span class="mi">8192</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </span><span class="o">|</span>
<span class="o">|</span><span class="w">               </span><span class="o">|</span><span class="w">           </span><span class="n">RepartitionExec</span><span class="p">:</span><span class="w"> </span><span class="n">partitioning</span><span class="o">=</span><span class="n">Hash</span><span class="p">([</span><span class="n">UserID</span><span class="o">@</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="n">input_partitions</span><span class="o">=</span><span class="mi">10</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </span><span class="o">|</span>
<span class="o">|</span><span class="w">               </span><span class="o">|</span><span class="w">             </span><span class="n">AggregateExec</span><span class="p">:</span><span class="w"> </span><span class="k">mode</span><span class="o">=</span><span class="k">Partial</span><span class="p">,</span><span class="w"> </span><span class="n">gby</span><span class="o">=</span><span class="p">[</span><span class="n">UserID</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">UserID</span><span class="p">],</span><span class="w"> </span><span class="n">aggr</span><span class="o">=</span><span class="p">[</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)]</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                                </span><span class="o">|</span>
<span class="o">|</span><span class="w">               </span><span class="o">|</span><span class="w">               </span><span class="n">DataSourceExec</span><span class="p">:</span><span class="w"> </span><span class="n">file_groups</span><span class="o">=</span><span class="err">{</span><span class="mi">10</span><span class="w"> </span><span class="n">groups</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="n">hits</span><span class="p">.</span><span class="n">parquet</span><span class="p">:</span><span class="mi">0</span><span class="p">..</span><span class="mi">1477997645</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">hits</span><span class="p">.</span><span class="n">parquet</span><span class="p">:</span><span class="mi">1477997645</span><span class="p">..</span><span class="mi">2955995290</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">hits</span><span class="p">.</span><span class="n">parquet</span><span class="p">:</span><span class="mi">2955995290</span><span class="p">..</span><span class="mi">4433992935</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">hits</span><span class="p">.</span><span class="n">parquet</span><span class="p">:</span><span class="mi">4433992935</span><span class="p">..</span><span class="mi">5911990580</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">hits</span><span class="p">.</span><span class="n">parquet</span><span class="p">:</span><span class="mi">5911990580</span><span class="p">..</span><span class="mi">7389988225</span><span class="p">],</span><span class="w"> </span><span class="p">...]</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="o">=</span><span class="p">[</span><span class="n">UserID</span><span class="p">],</span><span class="w"> </span><span class="n">file_type</span><span class="o">=</span><span class="n">parquet</span><span class="w">                                                                                                                                                                                                                                                    </span><span class="o">|</span>
<span class="o">|</span><span class="w">               </span><span class="o">|</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
<p>For this query, let’s again read the plan from the bottom to the top:</p>
<p><strong>Logical plan operators</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TableScan</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">hits.parquet</span></code>: Scans data from the file <code class="docutils literal notranslate"><span class="pre">hits.parquet</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">projection=[UserID]</span></code>: Reads only the <code class="docutils literal notranslate"><span class="pre">UserID</span></code> column</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Aggregate</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">groupBy=[[hits.parquet.UserID]]</span></code>: Groups by <code class="docutils literal notranslate"><span class="pre">UserID</span></code> column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aggr=[[count(Int64(1))</span> <span class="pre">AS</span> <span class="pre">count(*)]]</span></code>: Applies the <code class="docutils literal notranslate"><span class="pre">COUNT</span></code> aggregate on each distinct group.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Sort</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">count(*)</span> <span class="pre">DESC</span> <span class="pre">NULLS</span> <span class="pre">FIRST</span></code>: Sorts the data in descending count order.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fetch=10</span></code>: Returns only the first 10 rows.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Limit</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">skip=0</span></code>: Does not skip any data for the results.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fetch=10</span></code>: Limits the results to 10 values.</p></li>
</ul>
</li>
</ul>
<p><strong>Physical plan operators</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DataSourceExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">file_groups={10</span> <span class="pre">groups:</span> <span class="pre">[...]}</span></code>: Reads 10 groups in parallel from <code class="docutils literal notranslate"><span class="pre">hits.parquet</span></code>file. (The example above was run on a machine with 10 cores.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">projection=[UserID]</span></code>: Pushes down projection of the <code class="docutils literal notranslate"><span class="pre">UserID</span></code> column. The parquet format is columnar and the DataFusion reader only decodes the columns required.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">AggregateExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">mode=Partial</span></code> Runs a <a class="reference external" href="https://docs.rs/datafusion/latest/datafusion/physical_plan/aggregates/enum.AggregateMode.html#variant.Partial">partial aggregation</a> in parallel across each of the 10 partitions from the <code class="docutils literal notranslate"><span class="pre">DataSourceExec</span></code> immediately after reading.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gby=[UserID&#64;0</span> <span class="pre">as</span> <span class="pre">UserID]</span></code>: Represents <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> in the <a class="reference external" href="https://docs.rs/datafusion/latest/datafusion/physical_plan/aggregates/struct.PhysicalGroupBy.html">physical plan</a> and groups together the same values of <code class="docutils literal notranslate"><span class="pre">UserID</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aggr=[count(*)]</span></code>: Applies the <code class="docutils literal notranslate"><span class="pre">COUNT</span></code> aggregate on all rows for each group.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">RepartitionExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">partitioning=Hash([UserID&#64;0],</span> <span class="pre">10)</span></code>: Divides the input into into 10 (new) output partitions based on the value of <code class="docutils literal notranslate"><span class="pre">hash(UserID)</span></code>. You can read more about this in the <a class="reference external" href="https://docs.rs/datafusion/latest/datafusion/physical_plan/repartition/struct.RepartitionExec.html">partitioning</a> documentation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_partitions=10</span></code>: Number of input partitions.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CoalesceBatchesExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">target_batch_size=8192</span></code>: Combines smaller batches in to larger batches. In this case approximately 8192 rows in each batch.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">AggregateExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">mode=FinalPartitioned</span></code>: Performs the final aggregation on each group. See the <a class="reference external" href="https://docs.rs/datafusion/latest/datafusion/physical_plan/trait.Accumulator.html#tymethod.state">documentation on multi phase grouping</a> for more information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gby=[UserID&#64;0</span> <span class="pre">as</span> <span class="pre">UserID]</span></code>: Groups by <code class="docutils literal notranslate"><span class="pre">UserID</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aggr=[count(*)]</span></code>: Applies the <code class="docutils literal notranslate"><span class="pre">COUNT</span></code> aggregate on all rows for each group.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">SortExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">TopK(fetch=10)</span></code>: Use a special “TopK” sort that keeps only the largest 10 values in memory at a time. You can read more about this in the <a class="reference external" href="https://docs.rs/datafusion/latest/datafusion/physical_plan/struct.TopK.html">TopK</a> documentation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">expr=[count(*)&#64;1</span> <span class="pre">DESC]</span></code>: Sorts all rows in descending order. Note this represents the <code class="docutils literal notranslate"><span class="pre">ORDER</span> <span class="pre">BY</span></code> in the physical plan.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preserve_partitioning=[true]</span></code>: The sort is done in parallel on each partition. In this case the top 10 values are found for each of the 10 partitions, in parallel.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">SortPreservingMergeExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">[count(*)&#64;1</span> <span class="pre">DESC]</span></code>: This operator merges the 10 distinct streams into a single stream using this expression.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fetch=10</span></code>: Returns only the first 10 rows</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">GlobalLimitExec</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">skip=0</span></code>: Does not skip any rows</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fetch=10</span></code>: Returns only the first 10 rows, denoted by <code class="docutils literal notranslate"><span class="pre">LIMIT</span> <span class="pre">10</span></code> in the query.</p></li>
</ul>
</li>
</ul>
<section id="data-in-this-example">
<h3>Data in this Example<a class="headerlink" href="#data-in-this-example" title="Link to this heading">¶</a></h3>
<p>The examples in this section use data from <a class="reference external" href="https://benchmark.clickhouse.com/">ClickBench</a>, a benchmark for data
analytics. The examples are in terms of the 14GB <a class="reference external" href="https://datasets.clickhouse.com/hits_compatible/hits.parquet"><code class="docutils literal notranslate"><span class="pre">hits.parquet</span></code></a> file and can be
downloaded from the website or using the following commands:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>benchmarks
./bench.sh<span class="w"> </span>data<span class="w"> </span>clickbench_1
***************************
DataFusion<span class="w"> </span>Benchmark<span class="w"> </span>Runner<span class="w"> </span>and<span class="w"> </span>Data<span class="w"> </span>Generator
COMMAND:<span class="w"> </span>data
BENCHMARK:<span class="w"> </span>clickbench_1
DATA_DIR:<span class="w"> </span>/Users/andrewlamb/Software/datafusion2/benchmarks/data
CARGO_COMMAND:<span class="w"> </span>cargo<span class="w"> </span>run<span class="w"> </span>--release
PREFER_HASH_JOIN:<span class="w"> </span><span class="nb">true</span>
***************************
Checking<span class="w"> </span>hits.parquet......<span class="w"> </span>found<span class="w"> </span><span class="m">14779976446</span><span class="w"> </span>bytes<span class="w"> </span>...<span class="w"> </span>Done
</pre></div>
</div>
<p>Then you can run <code class="docutils literal notranslate"><span class="pre">datafusion-cli</span></code> to get plans:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>datafusion/benchmarks/data
datafusion-cli

DataFusion<span class="w"> </span>CLI<span class="w"> </span>v41.0.0
&gt;<span class="w"> </span><span class="k">select</span><span class="w"> </span>count<span class="o">(</span>*<span class="o">)</span><span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;hits.parquet&#39;</span><span class="p">;</span>
+----------+
<span class="p">|</span><span class="w"> </span>count<span class="o">(</span>*<span class="o">)</span><span class="w"> </span><span class="p">|</span>
+----------+
<span class="p">|</span><span class="w"> </span><span class="m">99997497</span><span class="w"> </span><span class="p">|</span>
+----------+
<span class="m">1</span><span class="w"> </span>row<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>fetched.
Elapsed<span class="w"> </span><span class="m">0</span>.062<span class="w"> </span>seconds.
&gt;
</pre></div>
</div>
</section>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="configs.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Configuration Settings</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="faq.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Frequently Asked Questions</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  
<!-- Based on pydata_sphinx_theme/footer.html -->
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2019-2025, Apache Software Foundation.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 8.2.3.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p>Apache DataFusion, Apache, the Apache feather logo, and the Apache DataFusion project logo</p>
      <p>are either registered trademarks or trademarks of The Apache Software Foundation in the United States and other countries.</p>
    </div>
  </div>
</footer>


  </body>
</html>