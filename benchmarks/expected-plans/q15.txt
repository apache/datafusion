+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                   |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: supplier.s_suppkey ASC NULLS LAST                                                                                                                                                                                |
|               |   Projection: supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_phone, revenue0.total_revenue                                                                                                        |
|               |     Inner Join: revenue0.total_revenue = __scalar_sq_1.__value                                                                                                                                                         |
|               |       Projection: supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_phone, revenue0.total_revenue                                                                                                    |
|               |         Inner Join: supplier.s_suppkey = revenue0.supplier_no                                                                                                                                                          |
|               |           TableScan: supplier projection=[s_suppkey, s_name, s_address, s_phone]                                                                                                                                       |
|               |           SubqueryAlias: revenue0                                                                                                                                                                                      |
|               |             Projection: lineitem.l_suppkey AS supplier_no, SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount) AS total_revenue                                                                             |
|               |               Aggregate: groupBy=[[lineitem.l_suppkey]], aggr=[[SUM(lineitem.l_extendedprice * (Decimal128(Some(1),20,0) - lineitem.l_discount)) AS SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]]   |
|               |                 Projection: lineitem.l_suppkey, lineitem.l_extendedprice, lineitem.l_discount                                                                                                                          |
|               |                   Filter: lineitem.l_shipdate >= Date32("9496") AND lineitem.l_shipdate < Date32("9587")                                                                                                               |
|               |                     TableScan: lineitem projection=[l_suppkey, l_extendedprice, l_discount, l_shipdate]                                                                                                                |
|               |       SubqueryAlias: __scalar_sq_1                                                                                                                                                                                     |
|               |         Projection: MAX(revenue0.total_revenue) AS __value                                                                                                                                                             |
|               |           Aggregate: groupBy=[[]], aggr=[[MAX(revenue0.total_revenue)]]                                                                                                                                                |
|               |             SubqueryAlias: revenue0                                                                                                                                                                                    |
|               |               Projection: SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount) AS total_revenue                                                                                                              |
|               |                 Aggregate: groupBy=[[lineitem.l_suppkey]], aggr=[[SUM(lineitem.l_extendedprice * (Decimal128(Some(1),20,0) - lineitem.l_discount)) AS SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]] |
|               |                   Projection: lineitem.l_suppkey, lineitem.l_extendedprice, lineitem.l_discount                                                                                                                        |
|               |                     Filter: lineitem.l_shipdate >= Date32("9496") AND lineitem.l_shipdate < Date32("9587")                                                                                                             |
|               |                       TableScan: lineitem projection=[l_suppkey, l_extendedprice, l_discount, l_shipdate]                                                                                                              |
| physical_plan | SortPreservingMergeExec: [s_suppkey@0 ASC NULLS LAST]                                                                                                                                                                  |
|               |   SortExec: expr=[s_suppkey@0 ASC NULLS LAST]                                                                                                                                                                          |
|               |     ProjectionExec: expr=[s_suppkey@0 as s_suppkey, s_name@1 as s_name, s_address@2 as s_address, s_phone@3 as s_phone, total_revenue@4 as total_revenue]                                                              |
|               |       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                      |
|               |         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "total_revenue", index: 4 }, Column { name: "__value", index: 0 })]                                                                       |
|               |           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                  |
|               |             RepartitionExec: partitioning=Hash([Column { name: "total_revenue", index: 4 }], 2), input_partitions=2                                                                                                    |
|               |               RepartitionExec: partitioning=RoundRobinBatch(2), input_partitions=2                                                                                                                                     |
|               |                 ProjectionExec: expr=[s_suppkey@0 as s_suppkey, s_name@1 as s_name, s_address@2 as s_address, s_phone@3 as s_phone, total_revenue@5 as total_revenue]                                                  |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                          |
|               |                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "s_suppkey", index: 0 }, Column { name: "supplier_no", index: 0 })]                                                           |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                      |
|               |                         RepartitionExec: partitioning=Hash([Column { name: "s_suppkey", index: 0 }], 2), input_partitions=0                                                                                            |
|               |                           MemoryExec: partitions=0, partition_sizes=[]                                                                                                                                                 |
|               |                       ProjectionExec: expr=[l_suppkey@0 as supplier_no, SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)@1 as total_revenue]                                                             |
|               |                         AggregateExec: mode=FinalPartitioned, gby=[l_suppkey@0 as l_suppkey], aggr=[SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]                                                    |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                  |
|               |                             RepartitionExec: partitioning=Hash([Column { name: "l_suppkey", index: 0 }], 2), input_partitions=2                                                                                        |
|               |                               AggregateExec: mode=Partial, gby=[l_suppkey@0 as l_suppkey], aggr=[SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]                                                       |
|               |                                 RepartitionExec: partitioning=RoundRobinBatch(2), input_partitions=0                                                                                                                   |
|               |                                   ProjectionExec: expr=[l_suppkey@0 as l_suppkey, l_extendedprice@1 as l_extendedprice, l_discount@2 as l_discount]                                                                    |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                        |
|               |                                       FilterExec: l_shipdate@3 >= 9496 AND l_shipdate@3 < 9587                                                                                                                         |
|               |                                         MemoryExec: partitions=0, partition_sizes=[]                                                                                                                                   |
|               |           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                  |
|               |             RepartitionExec: partitioning=Hash([Column { name: "__value", index: 0 }], 2), input_partitions=1                                                                                                          |
|               |               ProjectionExec: expr=[MAX(revenue0.total_revenue)@0 as __value]                                                                                                                                          |
|               |                 AggregateExec: mode=Final, gby=[], aggr=[MAX(revenue0.total_revenue)]                                                                                                                                  |
|               |                   CoalescePartitionsExec                                                                                                                                                                               |
|               |                     AggregateExec: mode=Partial, gby=[], aggr=[MAX(revenue0.total_revenue)]                                                                                                                            |
|               |                       ProjectionExec: expr=[SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)@1 as total_revenue]                                                                                         |
|               |                         AggregateExec: mode=FinalPartitioned, gby=[l_suppkey@0 as l_suppkey], aggr=[SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]                                                    |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                  |
|               |                             RepartitionExec: partitioning=Hash([Column { name: "l_suppkey", index: 0 }], 2), input_partitions=2                                                                                        |
|               |                               AggregateExec: mode=Partial, gby=[l_suppkey@0 as l_suppkey], aggr=[SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]                                                       |
|               |                                 RepartitionExec: partitioning=RoundRobinBatch(2), input_partitions=0                                                                                                                   |
|               |                                   ProjectionExec: expr=[l_suppkey@0 as l_suppkey, l_extendedprice@1 as l_extendedprice, l_discount@2 as l_discount]                                                                    |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                        |
|               |                                       FilterExec: l_shipdate@3 >= 9496 AND l_shipdate@3 < 9587                                                                                                                         |
|               |                                         MemoryExec: partitions=0, partition_sizes=[]                                                                                                                                   |
|               |                                                                                                                                                                                                                        |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+