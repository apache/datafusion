
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

#   http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

##########
## Truncate tests for MemTable
##########

# Test that TRUNCATE preserves table structure but removes data
statement ok
truncate table t1;

query I
select count(*) from t1;
----
0

query TT
describe t1;
----
a:Int32:None
b:Utf8:None
c:Float64:None
d:Int32:None

# Test TRUNCATE then INSERT works correctly
statement ok
truncate table t1;

statement ok
insert into t1 values (10, 'new', 1.23, 100);

query I
select count(*) from t1;
----
1

query I
select a from t1;
----
10

# Test multiple TRUNCATE operations
statement ok
insert into t1 values (20, 'another', 4.56, 200);

query I
select count(*) from t1;
----
2

statement ok
truncate table t1;

query I
select count(*) from t1;
----
0

# Truncate already empty table
statement ok
truncate table t1;

query I
select count(*) from t1;
----
0

# Clean up
statement ok
drop table t1;

statement ok
drop table test_schema.t5;

statement ok
drop schema test_schema;