
# Min/Max with largelist over integers
query ??
SELECT MIN(column1), MAX(column1) FROM VALUES
(arrow_cast(make_array(1, 2, 3, 4), 'LargeList(Int64)')),
(arrow_cast(make_array(1, 2), 'LargeList(Int64)'));
----
[1, 2] [1, 2, 3, 4]

# Min/Max with lists over strings
query ??
SELECT MIN(column1), MAX(column1) FROM VALUES
(arrow_cast(make_array('a', 'b', 'c'), 'LargeList(Utf8)')),
(arrow_cast(make_array('a', 'b'), 'LargeList(Utf8)'));
----
[a, b] [a, b, c]

# Min/Max with list over booleans
query ??
SELECT MIN(column1), MAX(column1) FROM VALUES
(arrow_cast(make_array(true, false, true), 'LargeList(Boolean)')),
(arrow_cast(make_array(true, false), 'LargeList(Boolean)'));
----
[true, false] [true, false, true]

# Min/Max with list over nullable integers
query ??
SELECT MIN(column1), MAX(column1) FROM VALUES
(arrow_cast(make_array(NULL, 1, 2), 'LargeList(Int64)')),
(arrow_cast(make_array(1, 2), 'LargeList(Int64)'));
----
[1, 2] [NULL, 1, 2]

# Min/Max list with different lengths and nulls
query ??
SELECT MIN(column1), MAX(column1) FROM VALUES
(arrow_cast(make_array(1, 2, 3, 4), 'LargeList(Int64)')),
(arrow_cast(make_array(1, 2), 'LargeList(Int64)')),
(arrow_cast(make_array(1, NULL, 3), 'LargeList(Int64)'));
----
[1, 2] [1, NULL, 3]

# Min/Max list with only NULLs
query ??
SELECT MIN(column1), MAX(column1) FROM VALUES
(arrow_cast(make_array(NULL, NULL), 'LargeList(Int64)')),
(arrow_cast(make_array(NULL), 'LargeList(Int64)'));
----
[NULL] [NULL, NULL]

# Min/Max list with empty lists
query ??
SELECT MIN(column1), MAX(column1) FROM VALUES
(arrow_cast(make_array(), 'LargeList(Int64)')),
(arrow_cast(make_array(), 'LargeList(Int64)')),
(arrow_cast(make_array(1), 'LargeList(Int64)'));
----
[] [1]

# Min/Max list of varying types (integers and NULLs)
query ??
SELECT MIN(column1), MAX(column1) FROM VALUES
(arrow_cast(make_array(1, 2, 3), 'LargeList(Int64)')),
(arrow_cast(make_array(NULL, 2, 3), 'LargeList(Int64)')),
(arrow_cast(make_array(1, 2, NULL), 'LargeList(Int64)'));
----
[1, 2, 3] [NULL, 2, 3]

# Min/Max list grouped by key with NULLs and differing lengths
query I?? rowsort
SELECT column1, MIN(column2), MAX(column2) FROM VALUES
(0, arrow_cast(make_array(1, NULL, 3), 'LargeList(Int64)')),
(0, arrow_cast(make_array(1, 2, 3, 4), 'LargeList(Int64)')),
(1, arrow_cast(make_array(1, 2), 'LargeList(Int64)')),
(1, arrow_cast(make_array(NULL, 5), 'LargeList(Int64)')),
(1, arrow_cast(make_array(), 'LargeList(Int64)'))
GROUP BY column1;
----
0 [1, 2, 3, 4] [1, NULL, 3]
1 [] [NULL, 5]

# Min/Max list grouped by key with NULLs and differing lengths
query I?? rowsort
SELECT column1, MIN(column2), MAX(column2) FROM VALUES
(0, arrow_cast(make_array(NULL), 'LargeList(Int64)')),
(0, arrow_cast(make_array(NULL, NULL), 'LargeList(Int64)')),
(1, arrow_cast(make_array(NULL), 'LargeList(Int64)'))
GROUP BY column1;
----
0 [NULL] [NULL, NULL]
1 [NULL] [NULL]

# Min/Max grouped list with empty and non-empty
query I?? rowsort
SELECT column1, MIN(column2), MAX(column2) FROM VALUES
(0, arrow_cast(make_array(), 'LargeList(Int64)')),
(0, arrow_cast(make_array(1), 'LargeList(Int64)')),
(0, arrow_cast(make_array(), 'LargeList(Int64)')),
(1, arrow_cast(make_array(5, 6), 'LargeList(Int64)')),
(1, arrow_cast(make_array(), 'LargeList(Int64)'))
GROUP BY column1;
----
0 [] [1]
1 [] [5, 6]

# Min/Max over lists with a window function
query ?
SELECT min(column1) OVER (ORDER BY column1) FROM VALUES
(arrow_cast(make_array(1, 2, 3), 'LargeList(Int64)')),
(arrow_cast(make_array(1, 2, 3), 'LargeList(Int64)')),
(arrow_cast(make_array(2, 3), 'LargeList(Int64)'))
----
[1, 2, 3]
[1, 2, 3]
[1, 2, 3]

# Min/Max over lists with a window function and nulls
query ?
SELECT min(column1) OVER (ORDER BY column1) FROM VALUES
(arrow_cast(make_array(NULL), 'LargeList(Int64)')),
(arrow_cast(make_array(4, 5), 'LargeList(Int64)')),
(arrow_cast(make_array(2, 3), 'LargeList(Int64)'))
----
[2, 3]
[2, 3]
[2, 3]

# Min/Max over lists with a window function, nulls and ROWS BETWEEN statement
query ?
SELECT min(column1) OVER (ORDER BY column1 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) FROM VALUES
(arrow_cast(make_array(NULL), 'LargeList(Int64)')),
(arrow_cast(make_array(4, 5), 'LargeList(Int64)')),
(arrow_cast(make_array(2, 3), 'LargeList(Int64)'))
----
[2, 3]
[2, 3]
[4, 5]

# Min/Max over lists with a window function using a different column
query ?
SELECT max(column2) OVER (ORDER BY column1 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) FROM VALUES
(arrow_cast(make_array(1, 2, 3), 'LargeList(Int64)'), arrow_cast(make_array(4, 5), 'LargeList(Int64)')),
(arrow_cast(make_array(2, 3), 'LargeList(Int64)'), arrow_cast(make_array(2, 3), 'LargeList(Int64)')),
(arrow_cast(make_array(1, 2, 3), 'LargeList(Int64)'), NULL);
----
[4, 5]
[4, 5]
[2, 3]
