# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

#   http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

query R
SELECT random(42::integer);
----
0.81430514512291

query R
SELECT random(0::integer);
----
0.324575268031407

query R
SELECT random(NULL::integer);
----
0.324575268031407

query BBB
SELECT
    random() BETWEEN 0.0 AND 1.0,
    random() = random(),
    random(1) = random(1);
----
true false true


query R
SELECT rand(42::integer);
----
0.81430514512291

query R
SELECT rand(0::integer);
----
0.324575268031407

query R
SELECT rand(NULL::integer);
----
0.324575268031407

query BBB
SELECT
    rand() BETWEEN 0.0 AND 1.0,
    rand() = rand(),
    rand(1) = rand(1);
----
true false true


query R
SELECT randn(42::integer);
----
0.834397546843796

query R
SELECT randn(0::integer);
----
-0.292803298604708

query R
SELECT randn(NULL::integer);
----
-0.292803298604708

query BB
SELECT
    randn() = randn(),
    randn(1) = randn(1);
----
false true


query T
SELECT randstr(3::integer, 42::integer);
----
0Us

query T
SELECT randstr(3::integer, 0::integer);
----
UYX

query T
SELECT randstr(3::integer, NULL::integer);
----
UYX

query error Execution error: `randstr` function expects a positive Int32 length argument
SELECT randstr(NULL::integer, 23::integer);

query error Execution error: `randstr` function expects a positive Int32 length argument
SELECT randstr(-2::integer, 23::integer);

query BB
SELECT
    randstr(10) = randstr(10),
    randstr(10, 2) = randstr(10, 2);
----
false true


query I
SELECT uniform(3::integer, 42::integer, 42::integer);
----
34

query I
SELECT uniform(0::integer, 34::integer, 12::integer);
----
19

query I
SELECT uniform(3::integer, 0::integer, 12::integer);
----
1

query R
SELECT uniform(3::float, 42::integer, 42::integer);
----
34.7579

query R
SELECT uniform(3::double, 42::integer, 42::integer);
----
34.75790065979348

query I
SELECT uniform(3::integer, NULL::integer);
----
NULL

query I
SELECT uniform(NULL::integer, 3::integer);
----
NULL

query BBBB
SELECT
    uniform(0, 1) BETWEEN 0 AND 1,
    uniform(0.0, 1.0) BETWEEN 0.0 AND 1.0,
    uniform(0.0, 1.0) = uniform(0.0, 1.0),
    uniform(10, 2, 23) = uniform(10, 2, 23);
----
true true false true
