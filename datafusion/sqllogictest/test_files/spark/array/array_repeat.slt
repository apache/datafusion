# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

#   http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.


query ?
SELECT array_repeat('123', 2);
----
[123, 123]

query ?
SELECT array_repeat('123', 0);
----
[]

query ?
SELECT array_repeat('123', -1);
----
[]

query ?
SELECT array_repeat('123', CAST('2' AS INT));
----
[123, 123]

query ?
SELECT array_repeat(123, 3);
----
[123, 123, 123]

query ?
SELECT array_repeat('2001-09-28T01:00:00'::timestamp, 2);
----
[2001-09-28T01:00:00, 2001-09-28T01:00:00]

query ?
SELECT array_repeat(array_repeat('123', CAST('2' AS INT)), CAST('3' AS INT));
----
[[123, 123], [123, 123], [123, 123]]

query ?
SELECT array_repeat(['123'], 2);
----
[[123], [123]]

query ?
SELECT array_repeat(NULL, 2);
----
NULL

query ?
SELECT array_repeat([NULL], 2);
----
[[NULL], [NULL]]

query ?
SELECT array_repeat(['123', NULL], 2);
----
[[123, NULL], [123, NULL]]

query ?
SELECT array_repeat('123', CAST(NULL AS INT));
----
NULL

query ?
SELECT array_repeat(column1, column2)
FROM VALUES
('123', 2),
('123', 0),
('123', -1),
(NULL, 1),
('123', NULL);
----
[123, 123]
[]
[]
NULL
NULL


query ?
SELECT array_repeat(column1, column2)
FROM VALUES
(['123'], 2),
([], 2),
([NULL], 2);
----
[[123], [123]]
[[], []]
[[NULL], [NULL]]
