# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

#   http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

#############
## Tests for Named Arguments (PostgreSQL-style param => value syntax)
#############

# Test positional arguments still work (baseline)
query T
SELECT substr('hello world', 7, 5);
----
world

# Test named arguments in order
query T
SELECT substr(str => 'hello world', start_pos => 7, length => 5);
----
world

# Test named arguments out of order
query T
SELECT substr(length => 5, str => 'hello world', start_pos => 7);
----
world

# Test mixed positional and named arguments
query T
SELECT substr('hello world', start_pos => 7, length => 5);
----
world

# Test with only 2 parameters (length optional)
query T
SELECT substr(str => 'hello world', start_pos => 7);
----
world

# Test all parameters named with substring alias
query T
SELECT substring(str => 'hello', start_pos => 1, length => 3);
----
hel

# Error: positional argument after named argument
query error DataFusion error: Error during planning: Positional argument.*follows named argument
SELECT substr(str => 'hello', 1, 3);

# Error: unknown parameter name
query error DataFusion error: Error during planning: Unknown parameter name 'invalid'
SELECT substr(invalid => 'hello', start_pos => 1, length => 3);

# Error: duplicate parameter name
query error DataFusion error: Error during planning: Parameter 'str' specified multiple times
SELECT substr(str => 'hello', str => 'world', start_pos => 1);

# Error: wrong number of arguments
# This query provides only 1 argument but substr requires 2 or 3
# The error message should show parameter names like "substr(str, start_pos)"
# instead of generic types like "substr(Any, Any)"
query error DataFusion error: Error during planning: Internal error: Function 'substr' failed to match any signature
SELECT substr(str => 'hello world');
