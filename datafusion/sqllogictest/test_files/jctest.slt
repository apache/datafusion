# --------------------------------------
# String_view specific tests
# --------------------------------------
statement ok
create table test_source as values
  ('Andrew', 'X', 'datafusionğŸ“ŠğŸ”¥', 'ğŸ”¥'),
  ('Xiangpeng', 'Xiangpeng', 'datafusionæ•°æ®èåˆ', 'datafusionæ•°æ®èåˆ'),
  ('Raphael', 'R', 'datafusionĞ”Ğ°Ñ‚Ğ°Ğ¤ÑƒÑĞ¸Ğ¾Ğ½', 'Ğ°Ğ¤ÑƒÑ'),
  ('under_score', 'un_____core', 'un iÅ›Ä‡ core', 'chrzÄ…szcz na Å‚Ä…ce w æ±äº¬éƒ½'),
  ('percent', 'p%t', 'pan Tadeusz ma iÅ›Ä‡ w kÄ…t', 'Pan Tadeusz ma frunÄ…Ä‡ stÄ…d w kÄ…t'),
  ('', '%', '', ''),
  ('%', '\%', '', ''),
  ('_', '\_', '', ''),
  (NULL, '%', NULL, NULL),
  (NULL, 'R', NULL, 'ğŸ”¥');

# --------------------------------------
# Setup test tables with different physical string types
# and repeat tests in `string_query.slt.part`
# --------------------------------------
statement ok
create table test_basic_operator as
select
    arrow_cast(column1, 'Utf8') as ascii_1,
    arrow_cast(column2, 'Utf8') as ascii_2,
    arrow_cast(column3, 'Utf8') as unicode_1,
    arrow_cast(column4, 'Utf8') as unicode_2
from test_source;

query TTTTTT
SELECT
  RIGHT(ascii_1, 3),
  RIGHT(ascii_1, 0),
  RIGHT(ascii_1, -3),
  RIGHT(unicode_1, 3),
  RIGHT(unicode_1, 0),
  RIGHT(unicode_1, -3)
FROM test_basic_operator;
----
rew (empty) rew nğŸ“ŠğŸ”¥ (empty) afusionğŸ“ŠğŸ”¥
eng (empty) ngpeng æ®èåˆ (empty) afusionæ•°æ®èåˆ
ael (empty) hael Ğ¸Ğ¾Ğ½ (empty) afusionĞ”Ğ°Ñ‚Ğ°Ğ¤ÑƒÑĞ¸Ğ¾Ğ½
ore (empty) er_score ore (empty) iÅ›Ä‡ core
ent (empty) cent kÄ…t (empty)  Tadeusz ma iÅ›Ä‡ w kÄ…t
(empty) (empty) (empty) (empty) (empty) (empty)
% (empty) (empty) (empty) (empty) (empty)
_ (empty) (empty) (empty) (empty) (empty)
NULL NULL NULL NULL NULL NULL
NULL NULL NULL NULL NULL NULL