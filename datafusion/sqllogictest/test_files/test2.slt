statement ok
CREATE TABLE test(
  i_item_desc VARCHAR,
  d1_date DATE,
  d2_date DATE,
  d3_date DATE
) as VALUES
  ('a','2022-12-12','2022-12-12','2022-12-12'),
  ('b','2022-12-12','2022-12-11','2022-12-12'),
  ('c','2022-12-12','2022-12-10','2022-12-12'),
  ('d','2022-12-12','2022-12-9','2022-12-12'),
  ('e','2022-12-12','2022-12-8','2022-12-12'),
  ('f','2022-12-12','2022-12-7','2022-12-12'),
  ('g','2022-12-12','2022-12-6','2022-12-12'),
  ('h','2022-12-12','2022-12-5','2022-12-12')
;

query DDI
select d1_date, d2_date, count(*) as c from test group by d2_date, d1_date order by c desc;
----
2022-12-12 2022-12-09 1
2022-12-12 2022-12-06 1
2022-12-12 2022-12-05 1
2022-12-12 2022-12-12 1
2022-12-12 2022-12-11 1
2022-12-12 2022-12-07 1
2022-12-12 2022-12-10 1
2022-12-12 2022-12-08 1
