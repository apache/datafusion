statement ok
CREATE TABLE tab1(col0 INTEGER, col1 INTEGER, col2 INTEGER)

statement ok
INSERT INTO tab1 VALUES(51,14,96)

# TODO this query used to (accidentally) pass before https://github.com/apache/datafusion/pull/17088
query error DataFusion error: Execution error: avg\(DISTINCT\) aggregations are not available
SELECT NULL * AVG(DISTINCT 4) + SUM(col1) AS col0 FROM tab1

query TT
EXPLAIN SELECT NULL * AVG(DISTINCT 4) + SUM(col1) AS col0 FROM tab1
----
logical_plan
01)Projection: Float64(NULL) AS col0
02)--Aggregate: groupBy=[[]], aggr=[[avg(DISTINCT Float64(4)) AS avg(DISTINCT Int64(4))]]
03)----TableScan: tab1 projection=[]
physical_plan
01)ProjectionExec: expr=[NULL as col0]
02)--AggregateExec: mode=Single, gby=[], aggr=[avg(DISTINCT Int64(4))]
03)----DataSourceExec: partitions=1, partition_sizes=[1]

# TODO this query used to (accidentally) pass before https://github.com/apache/datafusion/pull/17088
# Similar, with a few more arithmetic operations
query error DataFusion error: Execution error: avg\(DISTINCT\) aggregations are not available
SELECT + CAST ( NULL AS INTEGER ) * + + AVG ( DISTINCT 4 ) + - SUM ( ALL + col1 ) AS col0 FROM tab1

query TT
EXPLAIN SELECT + CAST ( NULL AS INTEGER ) * + + AVG ( DISTINCT 4 ) + - SUM ( ALL + col1 ) AS col0 FROM tab1
----
logical_plan
01)Projection: Float64(NULL) AS col0
02)--Aggregate: groupBy=[[]], aggr=[[avg(DISTINCT Float64(4)) AS avg(DISTINCT Int64(4))]]
03)----TableScan: tab1 projection=[]
physical_plan
01)ProjectionExec: expr=[NULL as col0]
02)--AggregateExec: mode=Single, gby=[], aggr=[avg(DISTINCT Int64(4))]
03)----DataSourceExec: partitions=1, partition_sizes=[1]
