# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

# tests for EXPLAIN with display schema enabled
statement ok
set datafusion.explain.show_schema = true;

# Test setup - create test table
statement ok
CREATE TABLE stock_price (
    company VARCHAR,
    price_date DATE,
    price INTEGER
);

# Insert sample data
statement ok
INSERT INTO stock_price VALUES
('DDOG', '2024-01-01', 125),
('DDOG', '2024-01-02', 128),
('DDOG', '2024-01-03', 132),
('DDOG', '2024-01-04', 129),
('DDOG', '2024-01-05', 135),
('DDOG', '2024-01-08', 138),
('DDOG', '2024-01-09', 141),
('DDOG', '2024-01-10', 139),
('DDOG', '2024-01-11', 143),
('DDOG', '2024-01-12', 147),
('AAPL', '2024-01-01', 185),
('AAPL', '2024-01-02', 187),
('AAPL', '2024-01-03', 189),
('AAPL', '2024-01-04', 186),
('AAPL', '2024-01-05', 191),
('AAPL', '2024-01-08', 193),
('AAPL', '2024-01-09', 195),
('AAPL', '2024-01-10', 192),
('AAPL', '2024-01-11', 197),
('AAPL', '2024-01-12', 199),
('MSFT', '2024-01-01', 375),
('MSFT', '2024-01-02', 378),
('MSFT', '2024-01-03', 382),
('MSFT', '2024-01-04', 379),
('MSFT', '2024-01-05', 385),
('MSFT', '2024-01-08', 388),
('MSFT', '2024-01-09', 391),
('MSFT', '2024-01-10', 389),
('MSFT', '2024-01-11', 393),
('MSFT', '2024-01-12', 396),
('GOOGL', '2024-01-01', 140),
('GOOGL', '2024-01-02', 142),
('GOOGL', '2024-01-03', 145),
('GOOGL', '2024-01-04', 143),
('GOOGL', '2024-01-05', 147),
('GOOGL', '2024-01-08', 149),
('GOOGL', '2024-01-09', 151),
('GOOGL', '2024-01-10', 148),
('GOOGL', '2024-01-11', 152),
('GOOGL', '2024-01-12', 154),
('AMZN', '2024-01-01', 150),
('AMZN', '2024-01-02', 152),
('AMZN', '2024-01-03', 155),
('AMZN', '2024-01-04', 153),
('AMZN', '2024-01-05', 157),
('AMZN', '2024-01-08', 159),
('AMZN', '2024-01-09', 161),
('AMZN', '2024-01-10', 158),
('AMZN', '2024-01-11', 162),
('AMZN', '2024-01-12', 164),
('TSLA', '2024-01-01', 248),
('TSLA', '2024-01-02', 251),
('TSLA', '2024-01-03', 255),
('TSLA', '2024-01-04', 252),
('TSLA', '2024-01-05', 258),
('TSLA', '2024-01-08', 261),
('TSLA', '2024-01-09', 264),
('TSLA', '2024-01-10', 262),
('TSLA', '2024-01-11', 266),
('TSLA', '2024-01-12', 269),
('NVDA', '2024-01-01', 485),
('NVDA', '2024-01-02', 492),
('NVDA', '2024-01-03', 498),
('NVDA', '2024-01-04', 495),
('NVDA', '2024-01-05', 502),
('NVDA', '2024-01-08', 508),
('NVDA', '2024-01-09', 515),
('NVDA', '2024-01-10', 512),
('NVDA', '2024-01-11', 518),
('NVDA', '2024-01-12', 525),
('META', '2024-01-01', 335),
('META', '2024-01-02', 338),
('META', '2024-01-03', 342),
('META', '2024-01-04', 339),
('META', '2024-01-05', 345),
('META', '2024-01-08', 348),
('META', '2024-01-09', 351),
('META', '2024-01-10', 349),
('META', '2024-01-11', 353),
('META', '2024-01-12', 356),
('NFLX', '2024-01-01', 485),
('NFLX', '2024-01-02', 488),
('NFLX', '2024-01-03', 492),
('NFLX', '2024-01-04', 489),
('NFLX', '2024-01-05', 495),
('NFLX', '2024-01-08', 498),
('NFLX', '2024-01-09', 501),
('NFLX', '2024-01-10', 499),
('NFLX', '2024-01-11', 503),
('NFLX', '2024-01-12', 506),
('CRM', '2024-01-01', 245),
('CRM', '2024-01-02', 248),
('CRM', '2024-01-03', 252),
('CRM', '2024-01-04', 249),
('CRM', '2024-01-05', 255),
('CRM', '2024-01-08', 258),
('CRM', '2024-01-09', 261),
('CRM', '2024-01-10', 259),
('CRM', '2024-01-11', 263),
('CRM', '2024-01-12', 266);
