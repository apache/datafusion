# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

# http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

###
## Setup test for postgres
###

onlyif postgres
statement ok
CREATE TABLE aggregate_test_100_by_sql
(
    c1  character varying NOT NULL,
    c2  smallint          NOT NULL,
    c3  smallint          NOT NULL,
    c4  smallint,
    c5  integer,
    c6  bigint            NOT NULL,
    c7  smallint          NOT NULL,
    c8  integer           NOT NULL,
    c9  bigint            NOT NULL,
    c10 character varying NOT NULL,
    c11 real              NOT NULL,
    c12 double precision  NOT NULL,
    c13 character varying NOT NULL
);

# Copy the data
onlyif postgres
statement ok
COPY aggregate_test_100_by_sql
    FROM '../../testing/data/csv/aggregate_test_100.csv'
    DELIMITER ','
    CSV HEADER;

###
## Setup test for datafusion
###
onlyif DataFusion
statement ok
CREATE EXTERNAL TABLE aggregate_test_100_by_sql (
  c1  VARCHAR NOT NULL,
  c2  TINYINT NOT NULL,
  c3  SMALLINT NOT NULL,
  c4  SMALLINT,
  c5  INT,
  c6  BIGINT NOT NULL,
  c7  SMALLINT NOT NULL,
  c8  INT NOT NULL,
  c9  BIGINT UNSIGNED NOT NULL,
  c10 VARCHAR NOT NULL,
  c11 FLOAT NOT NULL,
  c12 DOUBLE NOT NULL,
  c13 VARCHAR NOT NULL
)
STORED AS CSV
WITH HEADER ROW
LOCATION '../../testing/data/csv/aggregate_test_100.csv'




query RRRRR
SELECT
  abs(-1.1) as abs,
  exp(2.0) as exp,
  sin(3.0) as sin,
  cos(4.0) as cos,
  tan(5.0) as tan;
----
1.1 7.389056098931 0.14112000806 -0.653643620864 -3.380515006247


query I
select length('aÌˆ');
----
2


query I
SELECT 1 as num;
----
1


query IIT
SELECT
  c2,
  c3,
  c10
FROM aggregate_test_100_by_sql
ORDER BY c2 ASC, c3 DESC, c10;
----
1 125 17869394731126786457
1 120 16439861276703750332
1 103 10901819591635583995
1 83 4602675983996931623
1 71 10297218950720052365
1 70 4976799313755010034
1 57 4338034436871150616
1 54 17818611040257178339
1 41 15419512479294091215
1 38 1842662804748246269
1 36 7788847578701297242
1 29 14857091259186476033
1 12 15449267433866484283
1 -5 4776679784701509574
1 -8 9904216782086286050
1 -24 2402288956117186783
1 -25 12763583666216333412
1 -56 677091006469429514
1 -72 5885937420286765261
1 -85 12101411955859039553
1 -98 9634106610243643486
1 -99 14933742247195536130
2 122 15695681119022625322
2 113 4225581724448081782
2 97 2792105417953811674
2 93 5536487915963301239
2 68 3898128009708892708
2 63 13144161537396946288
2 52 12565360638488684051
2 52 7386391799827871203
2 49 10948666249269100825
2 45 8554426087132697832
2 31 3343692635488765507
2 29 562977550464243101
2 1 5863949479783605708
2 -29 11759014161799384683
2 -43 906367167997372130
2 -48 9135746610908713318
2 -60 1719090662556698549
2 -60 7045482583778080653
2 -61 939909697866979632
2 -106 7464432081248293405
2 -107 4403623840168496677
2 -117 12659011877190539078
3 123 12883447461717956514
3 112 9916295859593918600
3 104 13079037564113702254
3 97 8188072741116415408
3 77 17419098323248948387
3 73 2906943497598597237
3 71 3998472996619161534
3 22 196777795886465166
3 17 12662506238151717757
3 17 732272194388185106
3 14 8164671015278284913
3 13 10771380284714693539
3 13 14881411008939145569
3 -2 13062025193350212516
3 -12 16060348691054629425
3 -72 17452974532402389080
3 -76 12046662515387914426
3 -95 10966649192992996919
3 -101 17929716297117857676
4 123 4546434653720168472
4 102 2240998421986827216
4 97 9726016502640071617
4 96 5437030162957481122
4 74 10767179755613315144
4 73 9575476605699527641
4 65 11378396836996498283
4 55 1524771507450695976
4 47 2881913079548128905
4 30 13526465947516666293
4 17 3732692885824435932
4 5 35363005357834672
4 3 8622584762448622224
4 -38 878137512938218976
4 -53 9463973906560740422
4 -54 7966148640299601101
4 -56 2774306934041974261
4 -59 15100310750150419896
4 -79 2464584078983135763
4 -90 4094315663314091142
4 -101 16778113360088370541
4 -111 8382489916947120498
4 -117 13684453606722360110
5 118 16493024289408725403
5 68 9865419128970328044
5 64 16127995415060805595
5 62 10575647935385523483
5 36 17448660630302620693
5 -5 11429640193932435507
5 -31 11005002152861474932
5 -40 11720144131976083864
5 -44 2413406423648025909
5 -59 2501626630745849169
5 -82 3330177516592499461
5 -86 2126626171973341689
5 -94 12849419495718510869
5 -101 2243924747182709810


query IIT
SELECT
    c5,
    c4,
    c10
FROM aggregate_test_100_by_sql
ORDER BY c5 ASC, c4 DESC, c10;
----
-2141999138 -18655 13062025193350212516
-2141451704 -11122 17452974532402389080
-2138770630 21456 13144161537396946288
-2117946883 2045 2501626630745849169
-2098805236 13741 196777795886465166
-1991133944 13630 9634106610243643486
-1927628110 -1114 7464432081248293405
-1908480893 -21739 1719090662556698549
-1899175111 15673 8554426087132697832
-1885422396 -12612 10767179755613315144
-1882293856 -24085 2402288956117186783
-1813935549 -28462 11378396836996498283
-1808210365 -16312 7045482583778080653
-1660426473 -2888 939909697866979632
-1448995523 7652 15449267433866484283
-1383162419 27138 9904216782086286050
-1339586153 -5479 10297218950720052365
-1331533190 10837 16439861276703750332
-1302295658 15091 17419098323248948387
-1222533990 -30187 12659011877190539078
-1176490478 31106 17869394731126786457
-1143802338 28781 4338034436871150616
-1090239422 -12056 12565360638488684051
-1011669561 -2904 4403623840168496677
-1009656194 20690 2881913079548128905
-928766616 -21481 7788847578701297242
-903316089 29106 8188072741116415408
-842693467 -12484 2243924747182709810
-800561771 23127 3343692635488765507
-673237643 -28070 3732692885824435932
-644225469 -4667 15419512479294091215
-629486480 15788 2413406423648025909
-587831330 24495 10948666249269100825
-537142430 25305 11759014161799384683
-467659022 32514 2126626171973341689
-421042466 -6823 9916295859593918600
-382483011 -9565 2906943497598597237
-346989627 -13217 17929716297117857676
-335410409 18384 1842662804748246269
-237425046 5281 2464584078983135763
-168758331 10130 15695681119022625322
-134213907 19208 16493024289408725403
-108973366 3917 4225581724448081782
-4229382 -1967 8382489916947120498
41423756 16337 10575647935385523483
49866617 15874 3898128009708892708
61035129 -16110 13526465947516666293
141218956 8809 12046662515387914426
240273900 29533 12883447461717956514
370975815 13080 906367167997372130
383352709 15295 12763583666216333412
397430452 28162 8164671015278284913
427197269 -30336 5437030162957481122
431378678 -22186 10901819591635583995
434021400 -2376 7966148640299601101
439738328 -18025 9135746610908713318
586844478 -12907 11005002152861474932
623103518 -16974 17448660630302620693
659422734 -30508 8622584762448622224
670497898 14457 12662506238151717757
702611616 -7688 35363005357834672
706441268 22614 11720144131976083864
715235348 23388 7386391799827871203
762932956 20744 878137512938218976
794623392 12636 4776679784701509574
852509237 16620 4546434653720168472
912707948 32064 10771380284714693539
994303988 -18218 14857091259186476033
1171968280 -15154 12101411955859039553
1188089983 25590 5885937420286765261
1188285940 21576 9865419128970328044
1213926989 5613 14933742247195536130
1282464673 -22501 9575476605699527641
1299719633 12613 14881411008939145569
1325868318 27752 4976799313755010034
1337043149 -22796 732272194388185106
1354539333 -3855 562977550464243101
1413111008 -18410 17818611040257178339
1423957796 25286 15100310750150419896
1436496767 194 3998472996619161534
1489733240 -9168 16060348691054629425
1544188174 -31500 2774306934041974261
1579876740 -2935 4094315663314091142
1593800404 18167 2792105417953811674
1689098844 -26526 16127995415060805595
1738331255 -25136 13079037564113702254
1824882165 22080 3330177516592499461
1902023838 -1471 1524771507450695976
1955646088 24896 11429640193932435507
1991172974 -24558 2240998421986827216
1993193190 11640 16778113360088370541
2025611582 -15880 12849419495718510869
2030965207 13611 10966649192992996919
2033001162 18109 5863949479783605708
2047637360 -13181 9726016502640071617
2051224722 19316 13684453606722360110
2053379412 -12642 5536487915963301239
2064155045 13788 9463973906560740422
2106705285 8692 677091006469429514
2143473091 -14704 4602675983996931623


query IRII rowsort
SELECT * FROM
(VALUES (1,2.0,-3,1+1),(10,20.0,-30,2+2))
AS tbl(int_col, float_col, negative_col, summation);
----
1 2 -3 2
10 20 -30 4


query IIRIIIIII
SELECT
  count(*) AS count_all,
  count(c3) AS count_c3,
  avg(c3) AS avg,
  sum(c3) AS sum,
  max(c3) AS max,
  min(c3) AS min,
  bit_and(c3) as bit_and,
  bit_or(c3) as bit_or,
  bit_xor(c3) as bit_xor
FROM aggregate_test_100_by_sql;
----
100 100 7.81 781 125 -117 0 -1 -61


query IIRIIIIII
select
  c2,
  sum(c3) sum_c3,
  avg(c3) avg_c3,
  max(c3) max_c3,
  min(c3) min_c3,
  count(c3) count_c3,
  bit_and(c3) bit_and_c3,
  bit_or(c3) bit_or_c3,
  bit_xor(c3) bit_xor_c3
from aggregate_test_100_by_sql
group by c2
order by c2;
----
1 367 16.681818181818 125 -99 22 0 -1 -47
2 184 8.363636363636 122 -117 22 0 -1 -2
3 395 20.789473684211 123 -101 19 0 -1 101
4 29 1.260869565217 123 -117 23 0 -1 15
5 -194 -13.857142857143 118 -101 14 0 -1 -122


query I
SELECT
  t1.c9 result
FROM aggregate_test_100_by_sql t1
INNER JOIN aggregate_test_100_by_sql t2
ON t1.c9 = t2.c9
ORDER BY result;
----
28774375
63044568
141047417
141680161
145294611
225513085
243203849
326151275
431948861
466439833
473294098
520189543
538589788
557517119
559847112
598822671
662099130
754775609
774637006
811650497
879082834
933879086
974297360
1000948272
1013876852
1088543984
1098639440
1157161427
1229567292
1243785310
1289293657
1362369177
1365198901
1454057357
1491205016
1534194097
1538863055
1787652631
1824517658
1842680163
1865307672
1995343206
2013662838
2042457019
2093538928
2125812933
2214035726
2293105904
2306130875
2307004493
2424630722
2496054700
2502326480
2525744318
2592330556
2610290479
2669374863
2705709344
2712615025
2778168728
2818832252
2830981072
2844041986
2861376515
2861911482
2939920218
3023531799
3105312559
3126475872
3188005828
3198969145
3275293996
3276123488
3314983189
3342719438
3373581039
3398507249
3455216719
3457053821
3473924576
3521368277
3542840110
3566741189
3570297463
3577318119
3593959807
3625286410
3717551163
3759340273
3766999078
3862393166
3959216334
3998790955
4015442341
4061635107
4076864659
4144173353
4216440507
4229654142
4268716378


query TIIIIIIIITRRT
select * from aggregate_test_100_by_sql
order by c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13;
----
a 1 -85 -15154 1171968280 1919439543497968449 77 52286 774637006 12101411955859039553 0.12285209 0.686439196277 0keZ5G8BffGwgF2RwQD59TFzMStxCB
a 1 -56 8692 2106705285 -7811675384226570375 231 15573 1454057357 677091006469429514 0.42794758 0.273993852924 JN0VclewmjwYlSl8386MlWv5rEhWCz
a 1 -25 15295 383352709 4980135132406487265 231 102 3276123488 12763583666216333412 0.53796273 0.17592486906 XemNcT1xp61xcM1Qz3wZ1VECCnq06O
a 1 -5 12636 794623392 2909750622865366631 15 24022 2669374863 4776679784701509574 0.29877836 0.253725340799 waIGbOGl1PM6gnzZ4uuZt4E2yDWRHs
a 1 83 -14704 2143473091 -4387559599038777245 37 829 4015442341 4602675983996931623 0.89542526 0.956759554125 ErJFw6hzZ5fmI5r8bhE4JzlscnhKZU
a 2 -48 -18025 439738328 -313657814587041987 222 13763 3717551163 9135746610908713318 0.055064857 0.980019341044 ukyD7b0Efj7tNlFSRmzZ0IqkEzg2a8
a 2 -43 13080 370975815 5881039805148485053 2 20120 2939920218 906367167997372130 0.42733806 0.163011105157 m6jD0LBIQWaMfenwRCTANI9eOdyyto
a 2 45 15673 -1899175111 398282800995316041 99 2555 145294611 8554426087132697832 0.17333257 0.640526242956 b3b9esRhTzFEawbs6XhpKnD9ojutHB
a 3 -72 -11122 -2141451704 -2578916903971263854 83 30296 1995343206 17452974532402389080 0.94209343 0.323175061008 e2Gh6Ov8XkXoFdJWhl0EjwEHlMDYyG
a 3 -12 -9168 1489733240 -1569376002217735076 206 33821 3959216334 16060348691054629425 0.9488028 0.929388350248 oLZ21P2JEDooxV1pU31cIxQHEeeoLu
a 3 13 12613 1299719633 2020498574254265315 191 17835 3998790955 14881411008939145569 0.041445434 0.881316749782 Amn2K87Db5Es3dFQO9cw9cvpAM6h35
a 3 13 32064 912707948 3826618523497875379 42 21463 2214035726 10771380284714693539 0.6133468 0.732510667866 i6RQVXKUh7MzuGMDaNclUYnFUAireU
a 3 14 28162 397430452 -452851601758273256 57 14722 431948861 8164671015278284913 0.40199697 0.072604759609 TtDKUZxzVxsq758G6AWPSYuZgVgbcl
a 3 17 -22796 1337043149 -1282905594104562444 167 2809 754775609 732272194388185106 0.3884129 0.65867112904 VDhtJkYjAYPykCgOU9x3v7v3t4SO1a
a 4 -101 11640 1993193190 2992662416070659899 230 40566 466439833 16778113360088370541 0.3991115 0.574210838215 NEhyk8uIx4kEULJGa8qIyFjjBcP2G6
a 4 -54 -2376 434021400 5502271306323260832 113 15777 2502326480 7966148640299601101 0.5720931 0.305853751513 KJFcmTVjdkCMv94wYCtfHMFhzyRsmH
a 4 -38 20744 762932956 308913475857409919 7 45465 1787652631 878137512938218976 0.7459874 0.021825780392 ydkwycaISlYSlEq3TlkS2m15I2pcp8
a 4 65 -28462 -1813935549 7602389238442209730 18 363 1865307672 11378396836996498283 0.09130204 0.559324981528 WHmjWk2AY4c6m7DA4GitUx6nmb1yYS
a 5 -101 -12484 -842693467 -6140627905445351305 57 57885 2496054700 2243924747182709810 0.59520596 0.949139743286 QJYm7YRA3YetcBHI5wkMZeLXVmfuNy
a 5 -31 -12907 586844478 -4862189775214031241 170 28086 1013876852 11005002152861474932 0.35319167 0.055736622134 MeSTAXq8gVxVjbEjgkvU9YLte0X9uE
a 5 36 -16974 623103518 6834444206535996609 71 29458 141047417 17448660630302620693 0.17100024 0.044290730921 OF7fQ37GzaZ5ikA2oMyvleKtgnLjXh
b 1 12 7652 -1448995523 -5332734971209541785 136 49283 4076864659 15449267433866484283 0.6214579 0.05636955102 akiiY5N0I44CMwEnBL6RTBk7BRkxEj
b 1 29 -18218 994303988 5983957848665088916 204 9489 3275293996 14857091259186476033 0.53840446 0.179090351188 AyYVExXK6AR2qUTxNZ7qRHQOVGMLcz
b 1 54 -18410 1413111008 -7145106120930085900 249 5382 1842680163 17818611040257178339 0.8881188 0.248997943147 6FPJlLAcaQ5uokyOWZ9HGdLZObFvOZ
b 2 -60 -21739 -1908480893 -8897292622858103761 59 50009 2525744318 1719090662556698549 0.52930677 0.560333188635 l7uwDoTepWwnAP0ufqtHJS3CRi7RfP
b 2 31 23127 -800561771 -8706387435232961848 153 27034 1098639440 3343692635488765507 0.35692692 0.559020554835 okOkcWflkNXIy4R8LzmySyY1EC3sYd
b 2 63 21456 -2138770630 -2380041687053733364 181 57594 2705709344 13144161537396946288 0.09683716 0.305136408881 nYVJnVicpGRqKZibHyBAmtmzBXAFfT
b 2 68 15874 49866617 1179733259727844435 121 23948 3455216719 3898128009708892708 0.6306253 0.918581397074 802bgTGl6Bk5TlkPYYTxp5JkKyaYUA
b 3 -101 -13217 -346989627 5456800329302529236 26 54276 243203849 17929716297117857676 0.05422181 0.094656351238 MXhhH1Var3OzzJCtI9VNyYvA0q8UyJ
b 3 17 14457 670497898 -2390782464845307388 255 24770 1538863055 12662506238151717757 0.34077626 0.76143041007 6x93sxYioWuq5c9Kkk8oTAAORM7cH0
b 4 -117 19316 2051224722 -5534418579506232438 133 52046 3023531799 13684453606722360110 0.62608826 0.850672105305 mhjME0zBHbrK6NMkytMTQzOssOa1gF
b 4 -111 -1967 -4229382 1892872227362838079 67 9832 1243785310 8382489916947120498 0.06563997 0.152498292972 Sfx0vxv1skzZWT1PqVdoRDdO6Sb6xH
b 4 -59 25286 1423957796 2646602445954944051 0 61069 3570297463 15100310750150419896 0.49619365 0.04893135682 fuyvs0w7WsKSlXqJ1e6HFSoLmx03AG
b 4 17 -28070 -673237643 1904316899655860234 188 27744 933879086 3732692885824435932 0.41860116 0.403422831978 JHNgc2UCaiXOdmkxwDDyGhRlO0mnBQ
b 4 47 20690 -1009656194 -2027442591571700798 200 7781 326151275 2881913079548128905 0.57360977 0.214523264739 52mKlRE3aHCBZtjECq6sY9OqVf8Dze
b 5 -82 22080 1824882165 7373730676428214987 208 34331 3342719438 3330177516592499461 0.82634634 0.409753835253 Ig1QcuKsjHXkproePdERo2w0mYzIqd
b 5 -44 15788 -629486480 5822642169425315613 13 11872 3457053821 2413406423648025909 0.44318348 0.328693746871 ALuRhobVWbnQTTWZdSOk0iVe8oYFhW
b 5 -5 24896 1955646088 2430204191283109071 118 43655 2424630722 11429640193932435507 0.87989986 0.732805004129 JafwVLSVk5AVoXFuzclesQ000EE2k1
b 5 62 16337 41423756 -2274773899098124524 121 34206 2307004493 10575647935385523483 0.23794776 0.175426158671 qnPOOmslCJaT45buUisMRnM0rc77EK
b 5 68 21576 1188285940 5717755781990389024 224 27600 974297360 9865419128970328044 0.80895734 0.7973920073 ioEncce3mPOXD2hWhpZpCPWGATG6GU
c 1 -24 -24085 -1882293856 7385529783747709716 41 48048 520189543 2402288956117186783 0.39761502 0.360076636233 Fi4rJeTQq4eXj8Lxg3Hja5hBVTVV5u
c 1 41 -4667 -644225469 7049620391314639084 196 48099 2125812933 15419512479294091215 0.5780736 0.925503134643 mzbkwXKrPeZnxg2Kn1LRF5hYSsmksS
c 1 70 27752 1325868318 1241882478563331892 63 61637 473294098 4976799313755010034 0.13801557 0.508176556344 Ktb7GQ0N1DrxwkCkEUsTaIXk0xYinn
c 1 103 -22186 431378678 1346564663822463162 146 12393 3766999078 10901819591635583995 0.064453244 0.77849189835 2T3wSlHdEmASmO0xcXHnndkKEt6bz8
c 2 -117 -30187 -1222533990 -191957437217035800 136 47061 2293105904 12659011877190539078 0.2047385 0.970671228336 pLk3i59bZwd5KBZrI1FiweYTd5hteG
c 2 -107 -2904 -1011669561 782342092880993439 18 29527 1157161427 4403623840168496677 0.31988364 0.369363046006 QYlaIAnJA6r8rlAb6f59wcxvcPcWFf
c 2 -106 -1114 -1927628110 1080308211931669384 177 20421 141680161 7464432081248293405 0.56749094 0.56535284223 Vp3gmWunM5A7wOC9YW2JroFqTWjvTi
c 2 -60 -16312 -1808210365 -3368300253197863813 71 39635 2844041986 7045482583778080653 0.805363 0.642569411521 BJqx5WokrmrrezZA0dUbleMYkG5U2O
c 2 -29 25305 -537142430 -7683452043175617798 150 31648 598822671 11759014161799384683 0.8315913 0.946325164889 9UbObCsVkmYpJGcGrgfK90qOnwb2Lj
c 2 1 18109 2033001162 -6513304855495910254 25 43062 1491205016 5863949479783605708 0.110830784 0.929409733247 6WfVFBVGJSQb7FhA7E0lBwdvjfZnSW
c 2 29 -3855 1354539333 4742062657200940467 81 53815 3398507249 562977550464243101 0.7124534 0.991517828651 Oq6J4Rx6nde0YlhOIJkFsX2MsSvAQ0
c 3 -2 -18655 -2141999138 -3154042970870838072 251 34970 3862393166 13062025193350212516 0.034291923 0.769775338342 IWl0G3ZlMNf7WT8yjIB49cx7MmYOmr
c 3 22 13741 -2098805236 8604102724776612452 45 2516 1362369177 196777795886465166 0.94669616 0.049492446547 6oIXZuIPIqEoPBvFmbt2Nxy3tryGUE
c 3 73 -9565 -382483011 1765659477910680019 186 1535 1088543984 2906943497598597237 0.680652 0.600947554473 Ow5PGpfTm4dXCfTDsXAOTatXRoAydR
c 3 97 29106 -903316089 2874859437662206732 207 42171 3473924576 8188072741116415408 0.32792538 0.266717779508 HKSMQ9nTnwXCJIte1JrM1dtYnDtJ8g
c 4 -90 -2935 1579876740 6733733506744649678 254 12876 3593959807 4094315663314091142 0.5708688 0.560306236816 Ld2ej8NEv5zNcqU60FwpHeZKBhfpiV
c 4 -79 5281 -237425046 373011991904079451 121 55620 2818832252 2464584078983135763 0.49774808 0.923787797819 t6fQUjJejPcjc04wHvHTPe55S65B4V
c 4 3 -30508 659422734 -6455460736227846736 133 59663 2306130875 8622584762448622224 0.16999894 0.427312331893 EcCuckwsF3gV1Ecgmh5v4KM8g1ozif
c 4 123 16620 852509237 -3087630526856906991 196 33715 3566741189 4546434653720168472 0.07606989 0.81971586508 8LIh0b6jmDGm87BmIyjdxNIpX4ugjD
c 5 -94 -15880 2025611582 -3348824099853919681 5 40622 4268716378 12849419495718510869 0.34163946 0.483087855944 RilTlL1tKkPOUFuzmLydHAVZwv1OGl
c 5 118 19208 -134213907 -2120241105523909127 86 57751 1229567292 16493024289408725403 0.5536642 0.97235803965 TTQUwpMNSXZqVBKAFvXu7OlWvKXJKX
d 1 -99 5613 1213926989 -8863698443222021480 19 18736 4216440507 14933742247195536130 0.6067944 0.336395906593 aDxBtor7Icd9C5hnTvvw5NrIre740e
d 1 -98 13630 -1991133944 1184110014998006843 220 2986 225513085 9634106610243643486 0.89651865 0.164088254508 y7C453hRWd4E7ImjNDWlpexB8nUqjh
d 1 -72 25590 1188089983 3090286296481837049 241 832 3542840110 5885937420286765261 0.41980565 0.215354023438 wwXqSGKLyBQyPkonlzBNYUJTCo4LRS
d 1 -8 27138 -1383162419 7682021027078563072 36 64517 2861376515 9904216782086286050 0.80954456 0.946309824388 AFGCj7OWlEB5QfniEFgonMq90Tq5uH
d 1 38 18384 -335410409 -1632237090406591229 26 57510 2712615025 1842662804748246269 0.6064476 0.640449509335 4HX6feIvmNXBN7XGqgO4YVBkhu8GDI
d 1 57 28781 -1143802338 2662536767954229885 202 62167 879082834 4338034436871150616 0.7618384 0.429505217308 VY0zXmXeksCT8BzvpzpPLbmU9Kp9Y4
d 1 125 31106 -1176490478 -4306856842351827308 90 17910 3625286410 17869394731126786457 0.8882508 0.763123907005 dVdvo6nUD5FgCgsbOZLds28RyGTpnx
d 2 93 -12642 2053379412 6468763445799074329 147 50842 1000948272 5536487915963301239 0.4279275 0.285344285787 lqhzgLsXZ8JhtpeeUWWNbMz8PHI705
d 2 113 3917 -108973366 -7220140168410319165 197 24380 63044568 4225581724448081782 0.11867094 0.294415861805 90gAtmGEeIqUTbo1ZrxCvWtsseukXC
d 2 122 10130 -168758331 -3179091803916845592 30 794 4061635107 15695681119022625322 0.69592506 0.974836050902 OPwBqCEK5PWTjWaiOyL45u2NLTaDWv
d 3 -76 8809 141218956 -9110406195556445909 58 5494 1824517658 12046662515387914426 0.8557294 0.666842389741 Z2sWcQr0qyCJRMHDpRy3aQr7PkHtkK
d 3 77 15091 -1302295658 8795481303066536947 154 35477 2093538928 17419098323248948387 0.11952883 0.703563528317 O66j6PaYuZhEUtqV6fuU7TyjM2WxC5
d 3 123 29533 240273900 1176001466590906949 117 30972 2592330556 12883447461717956514 0.39075065 0.38870280984 1aOcrEGd0cOqZe2I5XBOm0nDcwtBZO
d 4 5 -7688 702611616 6239356364381313700 4 39363 3126475872 35363005357834672 0.3766935 0.061029375346 H5j5ZHy1FGesOAHjkQEDYCucbpKWRu
d 4 55 -1471 1902023838 1252101628560265705 157 3691 811650497 1524771507450695976 0.2968701 0.543759554042 f9ALCzwDAKmdu7Rk2msJaB1wxe5IBX
d 4 102 -24558 1991172974 -7823479531661596016 14 36599 1534194097 2240998421986827216 0.028003037 0.88248794476 0og6hSkhbX8AC1ktFS4kounvTzy8Vo
d 5 -59 2045 -2117946883 1170799768349713170 189 63353 1365198901 2501626630745849169 0.75173044 0.186288592659 F7NSTjWvQJyBburN7CXRUlbgp2dIrA
d 5 -40 22614 706441268 -7542719935673075327 155 14337 3373581039 11720144131976083864 0.69632107 0.311471253986 C2GT5KVyOPZpgKVl110TyZO0NcJ434
e 1 36 -21481 -928766616 -3471238138418013024 150 52569 2610290479 7788847578701297242 0.2578469 0.767002178615 gpo8K5qtYePve6jyPt6xgJx4YOVjms
e 1 71 -5479 -1339586153 -3920238763788954243 123 53012 4229654142 10297218950720052365 0.73473036 0.577349821706 cBGc0kSm32ylBDnxogG727C0uhZEYZ
e 1 120 10837 -1331533190 6342019705133850847 245 3975 2830981072 16439861276703750332 0.6623719 0.996540038759 LiEBxds3X0Uw0lxiYjDqrkAaAwoiIW
e 2 -61 -2888 -1660426473 2553892468492435401 126 35429 4144173353 939909697866979632 0.4405142 0.923188989694 BPtQMxnuSPpxMExYV9YkDa6cAN7GP3
e 2 49 24495 -587831330 9178511478067509438 129 12757 1289293657 10948666249269100825 0.5610077 0.59911381151 bgK1r6v3BCTh0aejJUhkA1Hn6idXGp
e 2 52 -12056 -1090239422 9011500141803970147 238 4168 2013662838 12565360638488684051 0.6694766 0.391444365692 xipQ93429ksjNcXPX5326VSg1xJZcW
e 2 52 23388 715235348 605432070100399212 165 56980 3314983189 7386391799827871203 0.46076488 0.98080963127 jQimhdepw3GKmioWUlVSWeBVRKFkY3
e 2 97 18167 1593800404 -9112448817105133638 163 45185 3188005828 2792105417953811674 0.38175434 0.409421835359 ukOiFGGFnQJDHFgZxHMpvhD3zybF0M
e 3 -95 13611 2030965207 927403809957470678 119 59134 559847112 10966649192992996919 0.5301289 0.047343434291 gTpyQnEODMcpsPnJMZC66gh33i3m0b
e 3 71 194 1436496767 -5639533800082367925 158 44507 3105312559 3998472996619161534 0.930117 0.610893830753 pTeu0WMjBRTaNRT15rLCuEh3tBJVc5
e 3 104 -25136 1738331255 300633854973581194 139 20807 3577318119 13079037564113702254 0.40154034 0.776436099031 DuJNG8tufSqW0ZstHqWj3aGvFLMg4A
e 3 112 -6823 -421042466 8535335158538929274 129 32712 3759340273 9916295859593918600 0.6424343 0.631656529655 BsM5ZAYifRh5Lw3Y8X1r53I0cTJnfE
e 4 -56 -31500 1544188174 3096047390018154410 220 417 557517119 2774306934041974261 0.15459597 0.191132935833 IZTkHMLvIKuiLjhDjYMmIHxh166we4
e 4 -53 13788 2064155045 -691093532952651300 243 35106 2778168728 9463973906560740422 0.34515214 0.271591905165 0VVIHzxWtNOFLtnhjHEKjXaJOSLJfm
e 4 30 -16110 61035129 -3356533792537910152 159 299 28774375 13526465947516666293 0.6999775 0.039683470858 cq4WSAIFwx3wwTUS5bp1wCe71R6U5I
e 4 73 -22501 1282464673 2541794052864382235 67 21119 538589788 9575476605699527641 0.48515016 0.296036538665 4JznSdBajNWhu4hRQwjV1FjTTxY68i
e 4 74 -12612 -1885422396 1702850374057819332 130 3583 3198969145 10767179755613315144 0.5518061 0.561450375462 QEHVvcP8gxI6EMJIrvcnIhgzPNjIvv
e 4 96 -30336 427197269 7506304308750926996 95 48483 3521368277 5437030162957481122 0.58104324 0.420731253319 3BEOHQsMEFZ58VcNTOJYShTBpAPzbt
e 4 97 -13181 2047637360 6176835796788944083 158 53000 2042457019 9726016502640071617 0.7085086 0.123575399884 oHJMNvWuunsIMIWFnYG31RCfkOo2V7
e 5 -86 32514 -467659022 -8012578250188146150 254 2684 2861911482 2126626171973341689 0.12559289 0.014793053078 gxfHWUF8XgY2KdFxigxvNEXe2V2XMl
e 5 64 -26526 1689098844 8950618259486183091 224 45253 662099130 16127995415060805595 0.2897315 0.575945048386 56MZa5O1hVtX4c5sbnCfxuX5kDChqI

# distinct_from logic for floats
query BBBBBBBBBBB
select 
    'nan'::float is distinct from 'nan'::float v7,
    'nan'::float is not distinct from 'nan'::float v8,
    'nan'::float is not distinct from null v9,
    'nan'::float is distinct from null v10,
    null is distinct from 'nan'::float v11,
    null is not distinct from 'nan'::float v12,
    1::float is distinct from 2::float v13,
    'nan'::float is distinct from 1::float v14,
    'nan'::float is not distinct from 1::float v15,
    1::float is not distinct from null v16,
    1::float is distinct from null v17
;
----
false true false true true false true true false false true

########
# Clean up after the test
########
statement ok
DROP TABLE aggregate_test_100_by_sql


statement ok
CREATE TABLE empty_table (
  c1  TEXT,
  c2  INT
);


query TI
select * from empty_table;
----
